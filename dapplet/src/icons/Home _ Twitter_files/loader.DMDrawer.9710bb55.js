(window.webpackJsonp=window.webpackJsonp||[]).push([[167],{"+Bsv":function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),l=a("3XMw"),s=a.n(l),i=a("M2x3"),o="settingsAppBar",c=a("/yvb"),d=a("rHpw");const u=s.a.bb081ea1,h={viewType:"settings_button"},p=r.a.memo((({onPress:e,pullRight:t,to:a})=>r.a.createElement(c.a,{accessibilityLabel:u,behavioralEventContext:h,hoverLabel:{label:u},icon:r.a.createElement(i.a,null),link:a,onPress:e,pullRight:t,style:m.button,testID:o,type:"primaryText"}))),m=d.a.create((e=>({button:{marginVertical:`calc(-${e.spaces.space12})`}})));t.a=p},"23An":function(e,t,a){"use strict";var n=a("ERkP"),r=n.useEffect,l=n.useRef;e.exports=function(){var e=l(!0);return r((function(){return e.current=!0,function(){e.current=!1}}),[]),e}},"3GUV":function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),l=a("rHpw"),s=a("MWbm");class i extends r.a.Component{shouldComponentUpdate(){return!1}render(){return r.a.createElement(s.a,{style:o.root})}}const o=l.a.create((e=>({root:{height:5*e.lineHeightsPx.body}})));t.a=i},"5UID":function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),l=a("3XMw"),s=a.n(l),i=a("rHpw"),o=a("+/1j"),c=a("MWbm");const d=s.a.e5b0063d;let u=0;class h extends r.a.Component{constructor(){super(),this._listDomId=`accessible-list-${u}`,u+=1}render(){const{children:e,title:t}=this.props,a=d({title:t});return r.a.createElement(c.a,{accessibilityLabelledBy:this._listDomId,accessibilityRole:"region"},r.a.createElement(o.a,{accessibilityLevel:1,accessibilityRole:"heading",nativeID:this._listDomId,style:i.a.visuallyHidden},t),r.a.createElement(c.a,{accessibilityLabel:a},e))}}t.a=h},"9SqB":function(e,t,a){"use strict";var n=a("IGGJ")(a("yiKp")),r=a("ERkP"),l=a("Ud88"),s=a("K1lQ").commitMutation,i=r.useState,o=r.useEffect,c=r.useRef,d=r.useCallback,u=a("23An");e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,a=l(),r=u(),h=c(a),p=c(e),m=c(new Set),g=i(!1),b=g[0],y=g[1],_=d((function(t){h.current===a&&p.current===e&&(m.current.delete(t),r.current&&y(m.current.size>0))}),[a,r,e]);o((function(){h.current===a&&p.current===e||(m.current=new Set,r.current&&y(!1),h.current=a,p.current=e)}),[a,r,e]);var E=d((function(l){var s=t(a,(0,n.default)((0,n.default)({},l),{},{mutation:e,onCompleted:function(e,t){_(s),l.onCompleted&&l.onCompleted(e,t)},onError:function(e){_(s),l.onError&&l.onError(e)},onUnsubscribe:function(){_(s),l.onUnsubscribe&&l.onUnsubscribe()}}));return m.current.add(s),r.current&&y(!0),s}),[_,t,a,r,e]);return[E,b]}},Avzu:function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),l=a("Lsrn"),s=a("k/Ka");const i=(e={})=>Object(s.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[l.a.root,e.style],viewBox:"0 0 24 24"},r.a.createElement("g",null,r.a.createElement("path",{d:"M23.25 3.25h-2.425V.825c0-.414-.336-.75-.75-.75s-.75.336-.75.75V3.25H16.9c-.414 0-.75.336-.75.75s.336.75.75.75h2.425v2.425c0 .414.336.75.75.75s.75-.336.75-.75V4.75h2.425c.414 0 .75-.336.75-.75s-.336-.75-.75-.75zm-3.175 6.876c-.414 0-.75.336-.75.75v8.078c0 .414-.337.75-.75.75H4.095c-.412 0-.75-.336-.75-.75V8.298l6.778 4.518c.368.246.79.37 1.213.37.422 0 .844-.124 1.212-.37l4.53-3.013c.336-.223.428-.676.204-1.012-.223-.332-.675-.425-1.012-.2l-4.53 3.014c-.246.162-.563.163-.808 0l-7.586-5.06V5.5c0-.414.337-.75.75-.75h9.094c.414 0 .75-.336.75-.75s-.336-.75-.75-.75H4.096c-1.24 0-2.25 1.01-2.25 2.25v13.455c0 1.24 1.01 2.25 2.25 2.25h14.48c1.24 0 2.25-1.01 2.25-2.25v-8.078c0-.415-.337-.75-.75-.75z"})));i.metadata={width:24,height:24},t.a=i},BUB3:function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),l=a("sNn6"),s=a("rHpw"),i=a("MWbm");const o=s.a.create((e=>({activeRoot:{backgroundColor:e.colors.gray0},overlay:{...s.a.absoluteFillObject,borderRightStyle:"solid",borderRightWidth:e.borderWidths.medium,borderRightColor:e.colors.primary,zIndex:1}})));t.a=({children:e,...t})=>r.a.createElement(l.a,t,(t=>r.a.createElement(i.a,{style:t&&o.activeRoot},"function"==typeof e?e(t):e,t?r.a.createElement(i.a,{pointerEvents:"none",style:o.overlay}):null)))},FS1z:function(e,t,a){"use strict";var n=a("KEM+"),r=a.n(n),l=a("ERkP"),s=a.n(l),i=a("rxPX"),o=a("0KEI");const c=(e,{module:t})=>t.selectFetchStatus(e),d=(e,{module:t})=>t.selectItems(e);var u=Object(i.a)().propsFromState((e=>({fetchStatus:c,items:d}))).propsFromActions((({module:e})=>({createLocalApiErrorHandler:Object(o.createLocalApiErrorHandlerWithContextFactory)("SLICES_TIMELINE"),fetch:e.fetch,fetchIfNeeded:e.fetchIfNeeded,fetchBottom:e.fetchBottom}))),h=a("v//M"),p=a("sIe2"),m=a("3XMw"),g=a.n(m),b=a("TEoO");const y=g.a.i9028824,_=e=>e,E={viewType:"timeline"};class v extends s.a.Component{constructor(...e){super(...e),r()(this,"_render",(()=>{const{footer:e,items:t,noItemsRenderer:a,numColumns:n,onScrollEnd:r,renderer:l,withoutHeadroom:i}=this.props;return!t||n<1?null:1===n?s.a.createElement(b.a,{cacheKey:"sliceTimeline",footer:e,identityFunction:_,items:t,noItemsRenderer:a,onNearEnd:this._handleNearEnd,onScrollEnd:r,renderer:l,withoutHeadroom:i}):s.a.createElement(p.a,{ListEmptyComponent:a,data:t,keyExtractor:_,numColumns:n,renderItem:l})})),r()(this,"_handleNearEnd",(()=>{const{createLocalApiErrorHandler:e,fetchBottom:t}=this.props;t().catch(e())})),r()(this,"_handleFetch",(()=>{const{alwaysFetch:e,createLocalApiErrorHandler:t,fetch:a,fetchIfNeeded:n}=this.props;(e?a:n)().catch(t())}))}componentDidMount(){this._handleFetch()}componentDidUpdate(e){const{module:t}=this.props;e.module!==t&&this._handleFetch()}render(){const{fetchStatus:e,module:t,retryMessage:a}=this.props;return t?s.a.createElement(h.a,{accessibilityLabel:y,behavioralEventContext:E,fetchStatus:e,onRequestRetry:this._handleFetch,render:this._render,retryMessage:a,retryable:!0}):null}}r()(v,"defaultProps",{numColumns:1,alwaysFetch:!1});const f=u(v);t.a=f},"ShJ/":function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),l=a("Lsrn"),s=a("k/Ka");const i=(e={})=>Object(s.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[l.a.root,e.style],viewBox:"0 0 24 24"},r.a.createElement("g",null,r.a.createElement("path",{d:"M20.472 14.738c-.388-1.808-2.24-3.517-3.908-4.246l-.474-4.307 1.344-2.016c.258-.387.28-.88.062-1.286-.218-.406-.64-.66-1.102-.66H7.54c-.46 0-.884.254-1.1.66-.22.407-.197.9.06 1.284l1.35 2.025-.42 4.3c-1.667.732-3.515 2.44-3.896 4.222-.066.267-.043.672.222 1.01.14.178.46.474 1.06.474h3.858l2.638 6.1c.12.273.39.45.688.45s.57-.177.688-.45l2.638-6.1h3.86c.6 0 .92-.297 1.058-.474.265-.34.288-.745.228-.988zM12 20.11l-1.692-3.912h3.384L12 20.11zm-6.896-5.413c.456-1.166 1.904-2.506 3.265-2.96l.46-.153.566-5.777-1.39-2.082h7.922l-1.39 2.08.637 5.78.456.153c1.355.45 2.796 1.78 3.264 2.96H5.104z"})));i.metadata={width:24,height:24},t.a=i},TEoO:function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),l=a("5UID"),s=a("3GUV"),i=a("iBK2");const o=r.a.createElement(s.a,null),c=({accessibilityTitle:e,...t})=>{const a=r.a.createElement(i.b,t);return e?r.a.createElement(l.a,{title:e},a):a};c.defaultProps={footer:o},t.a=c},X8um:function(e,t,a){"use strict";a.r(t);const n={fragment:{argumentDefinitions:r=[{defaultValue:null,kind:"LocalArgument",name:"label"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxQuery",selections:[{alias:"labeled_conversation_slice",args:l=[{kind:"Variable",name:"label",variableName:"label"},{kind:"Literal",name:"s",value:16}],concreteType:"DMLabeledConversationsSlice",kind:"LinkedField",name:"__DMPinnedInboxQuery_labeled_conversation_slice_slice",plural:!1,selections:[{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"items",plural:!0,selections:[s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"rest_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[o={alias:null,args:null,kind:"ScalarField",name:"conversation_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[o,c={alias:null,args:null,kind:"ScalarField",name:"conversation_type",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"created_at_millis",storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[s,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[h={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"original_img_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_height",storageKey:null}],type:"ApiImage",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[s,i,p={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id_str",storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"screen_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profile_image_url_https",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},m={alias:null,args:null,concreteType:"DMConversationLabelInfo",kind:"LinkedField",name:"labels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"SliceInfo",kind:"LinkedField",name:"slice_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"next_cursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"previous_cursor",storageKey:null}],storageKey:null},b={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:r,kind:"Operation",name:"DMPinnedInboxQuery",selections:[{alias:null,args:l,concreteType:"DMLabeledConversationsSlice",kind:"LinkedField",name:"labeled_conversation_slice",plural:!1,selections:[{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"items",plural:!0,selections:[s,i,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[o,{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[o,c,d,u,{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[s,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[y={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},h],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[y,{kind:"InlineFragment",selections:[s,i,p,{alias:null,args:null,filters:null,handle:"defaultScalars",key:"",kind:"LinkedHandle",name:"legacy"}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},m],storageKey:null},g,b],storageKey:null},{alias:null,args:l,filters:["label","s"],handle:"slice",key:"DMPinnedInboxQuery_labeled_conversation_slice",kind:"LinkedHandle",name:"labeled_conversation_slice"}]},params:{id:"xXzMbv-FpjF7-cHYcr05gw",metadata:{sliceInfoPath:["labeled_conversation_slice","slice_info"]},name:"DMPinnedInboxQuery",operationKind:"query",text:null}};var r,l,s,i,o,c,d,u,h,p,m,g,b,y;n.hash="a75c1dda87cc485eccb5aa8efb5739a4",t.default=n},ZH9U:function(e,t,a){"use strict";a.r(t);const n={fragment:{argumentDefinitions:r=[{defaultValue:null,kind:"LocalArgument",name:"conversation_id"},{defaultValue:null,kind:"LocalArgument",name:"label"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxAppend_Mutation",selections:l=[{alias:null,args:[{kind:"Variable",name:"conversation_id",variableName:"conversation_id"},{kind:"Variable",name:"label",variableName:"label"},{kind:"Literal",name:"s",value:16}],concreteType:null,kind:"LinkedField",name:"add_dm_conversation_label_v3",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"label_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],type:"DMConversationLabelInfo",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"failure_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"DMConversationLabelUnavailable",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:r,kind:"Operation",name:"DMPinnedInboxAppend_Mutation",selections:l},params:{id:"o0aymgGiJY-53Y52YSUGVA",metadata:{},name:"DMPinnedInboxAppend_Mutation",operationKind:"mutation",text:null}};var r,l;n.hash="86e5601441f8d07b68ccbcf112746d23",t.default=n},fuhe:function(e,t,a){"use strict";a.r(t),a.d(t,"DMDrawer",(function(){return Je}));var n=a("97Jx"),r=a.n(n),l=a("KEM+"),s=a.n(l),i=a("ERkP"),o=a.n(i),c=a("ZUOq"),d=a("MMRb"),u=a("RqPI"),h=a("rxPX"),p=a("0KEI");var m=Object(h.a)().propsFromState((()=>({conversations:d.selectConversations,drawerExperimentEnabled:d.selectDrawerExperimentEnabled,perspective:u.q,poppedOutConversationId:d.selectPoppedOutConversationId,visibility:d.selectDrawerVisibility}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(p.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_CONVERSATION"),fetchInboxIfNeeded:d.fetchInboxIfNeeded,loadDrawerVisibilityFromPersistence:d.loadDrawerVisibilityFromPersistence,setDrawerVisibility:d.setDrawerVisibility}))),g=a("V/6K"),b=a("CDB5"),y=a("1YZw"),_=a("hqKg"),E=a("X/yg"),v=a("AQOc"),f=a("UhuB"),S=a("l0YN"),I=a("G6rE"),k=a("P1r1");const C=(e,t)=>t.conversationId,x=Object(_.createSelector)(((e,t)=>d.selectEntriesForConversation(e,C(0,t))),u.q,((e,t)=>t?Object(E.d)(e,t):void 0)),w=e=>t=>b.c(e,t),F=e=>(t,a)=>b.a(e,t,a),M={conversation:(e,t)=>d.selectConversation(e,C(0,t)),entries:d.selectEntries,perspective:u.q,users:I.e.selectAll,dataSaverMode:k.k,dtabBarInfo:k.n,quickReplyOptions:x,visibility:d.selectDrawerVisibility,inboxUnreadCount:S.a,isUnread:(e,t)=>!d.selectConversationIsRead(e,C(0,t)),isDmReceiptSettingEnabled:f.n},T={draftText:(e,t)=>b.l(e,C(0,t)),gifMetadata:(e,t)=>b.h(e,C(0,t)),isUploading:(e,t)=>b.j(e,C(0,t)),media:(e,t)=>b.i(e,C(0,t)),mediaUploadProgress:(e,t)=>b.k(e,C(0,t))};var L=Object(h.a)().propsFromState((()=>({...M,...T}))).adjustStateProps((({conversation:e,dataSaverMode:t,draftText:a,dtabBarInfo:n,entries:r,gifMetadata:l,inboxUnreadCount:s,isDmReceiptSettingEnabled:i,isUnread:o,isUploading:c,media:d,mediaUploadProgress:u,perspective:h,quickReplyOptions:p,users:m,visibility:g})=>{const b=null==e?void 0:e.data;return{conversation:b&&Object(v.a)(b,r,m),perspective:h,dataSaverMode:t,draftText:a,dtabBarInfo:n,gifMetadata:l,inboxUnreadCount:s,isDmReceiptSettingEnabled:i,isUploading:c,isUnread:o,media:d,mediaUploadProgress:u,quickReplyOptions:p,visibility:g}})).propsFromActions((({conversationId:e})=>({addMedia:F(e),addToast:y.b,createLocalApiErrorHandler:Object(p.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_CONVERSATION"),fetchConversationHistory:d.fetchConversationHistory,removeMedia:w(e),saveText:b.f,sendMessage:b.m,updateConversationReadState:d.updateConversationReadState,updateTyping:d.updateTyping,fetchUpdatesIfNeeded:d.fetchUpdatesIfNeeded}))).withAnalytics({page:"messages",section:"thread_drawer"}),D=a("aWyx"),R=a("qz2E"),O=a("Oi4X"),P=a("OhSZ"),H=Object(h.a)().propsFromState((()=>({visibility:d.selectDrawerVisibility}))).propsFromActions((()=>({popOutConversation:d.popOutConversation,setDrawerVisibility:d.setDrawerVisibility}))).withAnalytics(),A=a("AQ79"),N=a("3XMw"),K=a.n(N),B=a("OrGc"),U=a("hACr"),j=a("fs1G"),V=a("MWbm"),z=a("/yvb"),q=a("Znyr"),G=a("t62R"),W=a("xKuM"),Q=a("rHpw"),$=a("v6aA"),X=a("95Se"),Y=a("Avzu"),Z=a("Lsrn"),J=a("k/Ka");const ee=(e={})=>Object(J.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[Z.a.root,e.style],viewBox:"0 0 24 24"},o.a.createElement("g",null,o.a.createElement("path",{d:"M12 19.344l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 19.344z"}),o.a.createElement("path",{d:"M12 11.535l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 11.535z"})));ee.metadata={width:24,height:24};var te=ee;const ae=(e={})=>Object(J.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[Z.a.root,e.style],viewBox:"0 0 24 24"},o.a.createElement("g",null,o.a.createElement("path",{d:"M12 4.656l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0L12 4.656z"}),o.a.createElement("path",{d:"M12 12.465l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0l8.72-8.72z"})));ae.metadata={width:24,height:24};var ne=ae,re=a("x0mb");const le=K.a.a2f8105f,se=K.a.d227d19e,ie=K.a.c64c1883,oe=K.a.j7d0e835,ce=K.a.b08821f3,de=K.a.e736990a,ue=K.a.cdcebd22;class he extends o.a.Component{constructor(...e){super(...e),s()(this,"_headerBar",o.a.createRef()),s()(this,"_appBarScrollEnabled",this.context.featureSwitches.isTrue("responsive_web_app_bar_scroll_enabled")),s()(this,"_isExpanded",(()=>{const{visibility:e}=this.props;return e===A.b.EXPANDED})),s()(this,"_renderLeftControl",(()=>{const{inboxUnreadCount:e}=this.props;return o.a.createElement(V.a,null,o.a.createElement(z.a,{accessibilityLabel:ce,icon:o.a.createElement(X.a,null),onPress:this._handleUnpopConvo,type:this._getButtonType()}),e&&e>0?o.a.createElement(q.a,{pip:!0,style:pe.newMessagePip,truncatedCountFormatter:()=>"",unreadCountLabel:()=>""}):null)})),s()(this,"_getButtonType",(()=>{const{hasNewMessages:e,isHighlighted:t}=this.props;return t&&e?"onMediaText":"primaryText"})),s()(this,"_renderRightControl",(()=>{const{conversationTitle:e}=this.props,t=this._isExpanded(),a=this._getButtonType();return o.a.createElement(V.a,{style:pe.rightControls},e?null:o.a.createElement(z.a,{accessibilityLabel:ie,hoverLabel:{label:ue},icon:o.a.createElement(Y.a,null),onPress:this._handleNewMessage,type:a}),t?o.a.createElement(z.a,{accessibilityLabel:se,hoverLabel:{label:se},icon:o.a.createElement(te,null),onPress:this._handleToggleVisibility,type:a}):o.a.createElement(z.a,{accessibilityLabel:oe,hoverLabel:{label:oe},icon:o.a.createElement(ne,null),onPress:this._handleToggleVisibility,type:a}))})),s()(this,"_handleUnpopConvo",(()=>{const{popOutConversation:e}=this.props;e(null)})),s()(this,"_handleToggleVisibility",(()=>{const{analytics:e,onDrawerOpen:t,setDrawerVisibility:a}=this.props,n=this._isExpanded()?A.b.COLLAPSED:A.b.EXPANDED;n===A.b.COLLAPSED?e.scribe({action:"collapse"}):n===A.b.EXPANDED&&(e.scribe({action:"expand"}),t&&t()),a(n)})),s()(this,"_handleToggleVisibilityKeyboard",(()=>{this._handleToggleVisibility(),this._headerBar&&this._headerBar.current&&this._headerBar.current.focus()})),s()(this,"_handleNewMessage",(()=>{const{analytics:e,history:t}=this.props;e.scribe({section:"compose_drawer",component:"dm",action:"show"}),t.push({pathname:"/messages/compose",state:{source:"drawer"}})})),s()(this,"_renderTitle",(()=>{const{conversationTitle:e,hasNewMessages:t,isHighlighted:a}=this.props,n=e||o.a.createElement(G.b,null,le);return o.a.createElement(V.a,{style:pe.titleContainer},o.a.createElement(V.a,{style:[pe.titleTextRoot,a&&t?pe.titleTextHighlighted:null]},n),t?o.a.createElement(V.a,{style:pe.newMessageDotContainer},o.a.createElement(re.a,{accessibilityLabel:de,style:[pe.newMessageDotRoot,a?pe.newMessageDotHighlighted:pe.newMessageDotRegular]})):null)}))}componentDidUpdate(e){const{hasNewMessages:t,isHighlighted:a,triggerHighlight:n}=this.props;e.isHighlighted||a||e.hasNewMessages||!t||n&&n()}render(){const{conversationSubtitle:e,conversationTitle:t,hasNewMessages:a,isHighlighted:n}=this.props,r=a?n?[pe.headerHighlighted]:[pe.headerActive]:[],l=this._isExpanded(),s=this._appBarScrollEnabled&&!n;return o.a.createElement(U.a,{enabled:!0,handlers:{[B.e.goLists]:j.a,[B.e.toggleDMDrawer]:this._handleToggleVisibilityKeyboard}},o.a.createElement(V.a,{ref:this._headerBar,style:[pe.headerRoot,!l&&pe.headerBorderClosed,...r,pe.cursor]},o.a.createElement(W.a,{leftControl:t&&this._isExpanded()?this._renderLeftControl():null,onMiddleControlClick:this._handleToggleVisibility,rightControl:this._renderRightControl(),style:this._appBarScrollEnabled?pe.roundedAppBarCorners:null,subtitle:e,title:this._renderTitle(),withBackground:s,withBottomBorder:!0})))}}s()(he,"contextType",$.a);const pe=Q.a.create((e=>({root:{alignSelf:"flex-end",backgroundColor:e.colors.navigationBackground,borderColor:e.colors.borderColor,borderWidth:e.borderWidths.small,marginRight:e.spaces.space20,width:c.a.columnWidths.secondary.normal},cursor:{cursor:"pointer"},expanded:{height:c.a.columnWidths.secondary.normal},headerRoot:{borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge,transition:"all 0.3s ease"},headerBorderClosed:{borderColor:e.colors.navigationBackground},headerActive:{backgroundColor:e.colors.unreadCellBackground},headerHighlighted:{borderColor:e.colors.primary,backgroundColor:e.colors.primary},titleContainer:{alignItems:"center",display:"flex",flexDirection:"row",flexGrow:1},titleTextRoot:{flexGrow:1,flexShrink:1},titleTextHighlighted:{color:e.colors.white},roundedAppBarCorners:{borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge},newMessageDotContainer:{flexGrow:1},newMessageDotRoot:{width:e.spaces.space12,height:e.spaces.space12,marginLeft:e.spaces.space4},newMessageDotRegular:{color:e.colors.primary},newMessageDotHighlighted:{color:e.colors.white},newMessagePip:{right:e.spaces.space4,top:e.spaces.space4},rightControls:{flexDirection:"row"}})));var me=H(he),ge=a("zb92");var be=Object(ge.a)({loader:()=>a.e(19).then(a.bind(null,"Rk1B"))}),ye=a("aWzz"),_e=a("XnpN"),Ee=a("GSsg"),ve=a("aITJ"),fe=a("yrzJ");class Se extends o.a.Component{constructor(e,t){super(e,t),s()(this,"_appBarScrollEnabled",this.context.featureSwitches.isTrue("responsive_web_app_bar_scroll_enabled")),s()(this,"_composer",o.a.createRef()),s()(this,"_renderConversation",((e,t)=>{const{conversationId:a,history:n,location:r}=this.props;return o.a.createElement(O.a,{conversationId:a,drawerHeader:this._appBarScrollEnabled?this._renderHeader():void 0,history:n,isWide:!1,location:r,richTextInputContext:e,typeaheadWrapper:t})})),s()(this,"_isExpanded",(()=>{const{visibility:e}=this.props;return e===A.b.EXPANDED})),s()(this,"_fetchUpdatesIfNeeded",(()=>{const{conversationId:e,createLocalApiErrorHandler:t,fetchUpdatesIfNeeded:a,isDmReceiptSettingEnabled:n}=this.props;a(n?{active_conversation_id:e,dm_users:!0}:{}).catch(t())})),Object(R.a)()}componentDidMount(){this._updatePolling()}componentDidUpdate(e){e.visibility!==this.props.visibility&&this._updatePolling()}render(){const e=this._isExpanded();return o.a.createElement(o.a.Fragment,null,e&&this._appBarScrollEnabled?null:this._renderHeader(),e?ve.b.isDesktopOS()?o.a.createElement(be,null,(({richTextInputContext:e,typeaheadWrapper:t})=>this._renderConversation(e,t))):this._renderConversation():null)}_renderHeader(){const{conversation:e,history:t,inboxUnreadCount:a,isHeaderHighlighted:n,isUnread:r,onDrawerOpen:l,perspective:s,triggerHeaderHighlight:i}=this.props,c=n?"white":"normal",d=n?"white":"gray700",u=e&&e.type===D.a.ONE_TO_ONE&&s&&Object(_e.a)(e,s).map((({user:e})=>e.screen_name)),h=u?o.a.createElement(fe.a,{color:d,screenName:u[0]}):void 0;return o.a.createElement(V.a,{style:this._appBarScrollEnabled?[Ie.headerRoot,Ie.appBarZIndex]:Ie.appBarZIndex},o.a.createElement(me,{conversationSubtitle:h,conversationTitle:o.a.createElement(P.b,{conversation:e,perspective:s,textColor:c,withScreenName:!1}),hasNewMessages:r,history:t,inboxUnreadCount:a,isHighlighted:n,onDrawerOpen:l,triggerHighlight:i}))}_updatePolling(){this._pollingTimer&&this._pollingTimer.stop(),this.props.visibility===A.b.COLLAPSED&&(this._pollingTimer=new Ee.a(this._fetchUpdatesIfNeeded,{interval:3e3}),this._pollingTimer.start())}getChildContext(){return{getCustomLocation:null}}}s()(Se,"contextType",$.a),s()(Se,"childContextTypes",{getCustomLocation:ye.func});const Ie=Q.a.create((e=>({appBarZIndex:{zIndex:e.componentZIndices.appBarZIndex},headerRoot:{position:"sticky",top:0}})));var ke=L(Se),Ce=a("4q8G"),xe=a("tn7R");var we=Object(h.a)().propsFromState((()=>({conversations:d.selectConversations,settings:k.g,unreadCount:S.a,untrustedConversationCount:d.selectUntrustedConversationCount,untrustedUnreadCount:d.selectUntrustedUnreadCount,visibility:d.selectDrawerVisibility}))).adjustStateProps((({conversations:e,settings:t,unreadCount:a,untrustedConversationCount:n,untrustedUnreadCount:r,visibility:l})=>{const s=[];for(const t of Object(xe.a)(e)){var i;!t.isDeleted&&null!==(i=t.data)&&void 0!==i&&i.trusted&&s.push(t.data)}s.sort(Ce.a);const o=a>0;return{allowUntrustedInbox:"all"===t.allow_dms_from||n>0,conversationIds:s.map((e=>e.conversation_id)),isUnread:o,untrustedUnreadCount:r,visibility:l}})).propsFromActions((()=>({createLocalApiErrorHandler:Object(p.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX"),fetchInbox:d.fetchInbox,fetchInboxHistory:d.fetchTrustedInboxHistory,fetchInboxIfNeeded:d.fetchInboxIfNeeded,fetchUpdates:d.fetchUpdatesIfNeeded,updateLastSeenEventId:d.updateTrustedLastSeenEventId,popOutConversation:d.popOutConversation}))).withAnalytics({page:"messages",section:"inbox_drawer"}),Fe=a("cFyg"),Me=a("pXKu"),Te=a("nySH"),Le=a("yw4N"),De=a("FIs5"),Re=a("csss");const Oe=K.a.a2f8105f,Pe=K.a.b8aa3744,He=K.a.j06309e1,Ae=K.a.gee5150a,Ne=K.a.cf2d1047,Ke=K.a.da2f9224,Be=K.a.h6beb5fa;class Ue extends o.a.Component{constructor(...e){super(...e),s()(this,"_appBarScrollEnabled",this.context.featureSwitches.isTrue("responsive_web_app_bar_scroll_enabled")),s()(this,"_renderHeader",(()=>{const{history:e,isHeaderHighlighted:t,isUnread:a,onDrawerOpen:n,triggerHeaderHighlight:r}=this.props;return o.a.createElement(V.a,{style:this._appBarScrollEnabled?[je.headerRoot,je.appBarZIndex]:je.appBarZIndex},o.a.createElement(me,{hasNewMessages:a,history:e,isHighlighted:t,onDrawerOpen:n,triggerHighlight:r}))})),s()(this,"_renderExpandedInbox",(()=>{const{analytics:e,conversationIds:t,fetchInboxHistory:a,updateLastSeenEventId:n}=this.props;return o.a.createElement(V.a,{style:je.fill},o.a.createElement(V.a,{style:[je.viewportView,this._appBarScrollEnabled&&Fe.b.drawerHeaderRadius]},o.a.createElement(Le.a,{style:[je.viewportView,this._appBarScrollEnabled&&Fe.b.drawerHeaderRadius]},this._appBarScrollEnabled&&this._renderHeader(),o.a.createElement(Me.a,{accessibilityTitle:Oe,analytics:e,conversationIds:t,customCellClick:this._dmDrawerOnClick,fetchInboxHistory:a,isDrawer:!0,renderEmptyDMInbox:this._renderEmptyDMInbox,renderStickyContent:this._renderPivot,updateLastSeenEventId:n,virtualScrollerCacheKey:"dmDrawerInbox",withPinnedInbox:!0}))))})),s()(this,"_renderEmptyDMInbox",(()=>o.a.createElement(o.a.Fragment,null,this._renderPivot(),o.a.createElement(De.a,{buttonLink:"/messages/compose",buttonText:Ae,header:Pe,message:He,onImpression:this._handleEmptyDMInboxImpression})))),s()(this,"_isExpanded",(()=>{const{visibility:e}=this.props;return e===A.b.EXPANDED})),s()(this,"_dmDrawerOnClick",((e,t)=>{const{popOutConversation:a}=this.props;a(t),e.preventDefault()})),s()(this,"_handleEmptyDMInboxImpression",(()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})})),s()(this,"_handleRequestsPivotClick",(()=>{const{analytics:e}=this.props;e.scribe({element:"requests_pivot",action:"click"})})),s()(this,"_renderPivot",(()=>{const{allowUntrustedInbox:e}=this.props;return e?o.a.createElement(V.a,{style:je.requestPivotContainer},o.a.createElement(Re.a,{label:Ne,link:Object(Te.a)(A.d.SECONDARY),onPress:this._handleRequestsPivotClick,renderRightContent:this._renderPivotBadge})):null})),s()(this,"_renderPivotBadge",(()=>{const{untrustedUnreadCount:e}=this.props;return e>0?o.a.createElement(q.a,{count:e,standalone:!0,truncatedCountFormatter:Be,unreadCountLabel:Ke}):null}))}componentDidUpdate(){this._isExpanded()&&Object(R.a)()}render(){const e=this._isExpanded();return o.a.createElement(o.a.Fragment,null,e&&this._appBarScrollEnabled?null:this._renderHeader(),e&&this._renderExpandedInbox())}}s()(Ue,"contextType",$.a);const je=Q.a.create((e=>({fill:{flex:1,alignSelf:"stretch"},headerRoot:{position:"sticky",top:0},appBarZIndex:{zIndex:e.componentZIndices.appBarZIndex},requestPivotContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:2},viewportView:{...Q.a.absoluteFillObject,overflowY:"auto"}})));var Ve=we(Ue),ze=a("YeIG"),qe=a("A69o"),Ge="DMDrawer",We=a("TnY3"),Qe=a("0FVZ"),$e=a("Oe3h"),Xe=a("nBUg");const Ye={isGlobal:!0,isSticky:!0},Ze={isGlobal:!0,isSticky:!1};class Je extends o.a.PureComponent{constructor(...e){super(...e),s()(this,"state",{isHeaderHighlighted:!1,hasStartedInitialFetch:!1,unexpandedHeight:void 0}),s()(this,"_handleLayout",(e=>{const{nativeEvent:{layout:{height:t}}}=e,{unexpandedHeight:a}=this.state;this._isExpanded()||void 0!==a||this.setState({unexpandedHeight:t})})),s()(this,"_showDMDrawer",(()=>{const{conversations:e,visibility:t}=this.props,a=t===A.b.CLOSED;return!this._isHideDMDrawerPath()&&!Object(ze.a)(e)&&!a})),s()(this,"_isExpanded",(()=>{const{visibility:e}=this.props;return e===A.b.EXPANDED})),s()(this,"_triggerHeaderHighlight",(()=>{const{isHeaderHighlighted:e}=this.state;this._isExpanded()||e||this._headerHighlightTimeoutId||(this.setState({isHeaderHighlighted:!0}),this._headerHighlightTimeoutId=setTimeout((()=>{this.setState({isHeaderHighlighted:!1}),this._headerHighlightTimeoutId=void 0}),3e3))})),s()(this,"_handleDrawerOpen",(()=>{const{isHeaderHighlighted:e}=this.state;e&&(this.setState({isHeaderHighlighted:!1}),clearTimeout(this._headerHighlightTimeoutId),this._headerHighlightTimeoutId=void 0)})),s()(this,"_isOnOcfFlow",(()=>{const{location:e}=this.props;return e.pathname.startsWith("/i/flow")})),s()(this,"_isOnBirdwatchPage",(()=>{const{location:e}=this.props;return e.pathname.startsWith("/i/birdwatch")})),s()(this,"_isHideDMDrawerPath",(()=>this._isOnOcfFlow()||this._isOnBirdwatchPage()))}componentWillUnmount(){clearTimeout(this._headerHighlightTimeoutId)}componentDidUpdate(){this._loadInboxDataIfNeeded()}componentDidMount(){this._loadInboxDataIfNeeded()}render(){const{history:e,location:t,perspective:a,poppedOutConversationId:n,width:l}=this.props,{isHeaderHighlighted:s,unexpandedHeight:i}=this.state,c=this._isExpanded();return this._showDMDrawer()?o.a.createElement(Qe.a.Drawer,null,o.a.createElement($e.a,{id:"DMDrawer"},((d,u)=>o.a.createElement(g.a.Provider,{value:{isDrawer:!0}},o.a.createElement(Xe.b.Provider,{value:{isDMDrawer:()=>!0}},o.a.createElement(V.a,r()({ref:d()},u({style:[Fe.b.root,{width:l}],testID:Ge})),o.a.createElement(V.a,{onLayout:i?void 0:this._handleLayout,style:[Fe.b.expandable,{height:i,maxHeight:i},c&&Fe.b.expanded]},n?o.a.createElement(qe.a.Provider,{value:Ze},o.a.createElement(ke,{conversationId:n,history:e,isHeaderHighlighted:s,location:t,onDrawerOpen:this._handleDrawerOpen,perspective:a,triggerHeaderHighlight:this._triggerHeaderHighlight})):o.a.createElement(qe.a.Provider,{value:Ye},o.a.createElement(Ve,{history:e,isHeaderHighlighted:s,onDrawerOpen:this._handleDrawerOpen,triggerHeaderHighlight:this._triggerHeaderHighlight}))))))))):null}_loadInboxDataIfNeeded(){const{createLocalApiErrorHandler:e,fetchInboxIfNeeded:t,loadDrawerVisibilityFromPersistence:a}=this.props,{hasStartedInitialFetch:n}=this.state;this._isHideDMDrawerPath()||n||(a(),t().catch(e()),this.setState({hasStartedInitialFetch:!0}))}}s()(Je,"defaultProps",{width:c.a.dmDrawerWidth.max});const et=m(Je);t.default=Object(We.a)(et)},kb9v:function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),l=a("TIdA"),s=a("t62R"),i=a("A91F"),o=a("/yvb"),c=a("Eqye"),d=a("efqG"),u=a("sgih"),h=a("rHpw"),p=a("MWbm"),m=a("3dyc");const g=h.a.create((e=>({root:{paddingVertical:e.spacesPx.space32},rootWithImage:{paddingTop:0},graphic:{marginBottom:e.spacesPx.space20},icon:{alignSelf:"center",height:e.spacesPx.space64,width:e.spacesPx.space64},container:{paddingHorizontal:e.spacesPx.space32},description:{marginTop:e.spacesPx.space8,marginBottom:e.spacesPx.space4},actionButton:{marginTop:e.spacesPx.space16}})));t.a=({actionPrimary:e,actionSecondary:t,children:a,headline:n,icon:b,iconColor:y,imageUrl:_,onDismiss:E,shouldDisplay:v,text:f,withMask:S=!0})=>{const[I,k]=r.a.useState(!1),C=e=>r.a.createElement(d.a,{onDismiss:D,renderContent:()=>w(D),switchOnlyOnXSmallBreakpoint:!0,visibilityBehavior:m.b.forceVisible,withArrow:!0,withFixedPosition:!0,withMask:S},e),x=()=>r.a.createElement(u.a,{onMaskClick:()=>D(),type:"center",withMask:!0},w(D)),w=a=>r.a.createElement(p.a,{style:[g.root,_&&g.rootWithImage]},F(),r.a.createElement(p.a,{style:g.container},M(),T(),L({action:e,dismiss:a,type:t&&"primaryFilled"}),L({action:t,dismiss:a}))),F=()=>{let e=b&&r.a.createElement(b,{style:y?[g.icon,{color:h.a.theme.colors[y]}]:g.icon});return _&&!c.a.isEnabled&&(e=r.a.createElement(l.a,{accessibilityLabel:"",aspectMode:i.a.exact(2),image:_})),e&&r.a.createElement(p.a,{style:g.graphic},e)},M=()=>r.a.createElement(s.b,{size:"title3",weight:"heavy"},n),T=()=>r.a.createElement(s.b,{color:"gray700",style:g.description},f),L=({action:e,dismiss:t,type:a})=>e&&r.a.createElement(o.a,{link:e.link&&e.link,onPress:e.onClick?e.onClick:t,size:"large",style:g.actionButton,type:a},e.text),D=()=>{E&&E(),k(!0)};return v&&!I?a?C(a):x():a||null}},nySH:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return b}));var n=a("ERkP"),r=a.n(n),l=a("HPNB"),s=a("v6aA"),i=a("jYSG"),o=a("AQ79"),c=a("+Bsv"),d=a("MWbm"),u=a("cHvH"),h=a("t62R"),p=a("rHpw");const m=e=>{switch(e){case o.d.SECONDARY:return"/messages/requests";case o.d.TERTIARY:return"/messages/requests/additional";case o.d.PRIMARY:default:return"/messages"}},g=(e,t)=>r.a.createElement(s.a.Consumer,null,(({featureSwitches:a})=>{const n=a.isTrue("responsive_web_settings_revamp_enabled")?e:"/settings/safety";return r.a.createElement(c.a,{pullRight:t,to:n})})),b=e=>r.a.createElement(u.a,null,(({windowWidth:t})=>{const a=l.a.isTwoColumnLayout(t),n=0===e.length;return a||n?null:r.a.createElement(d.a,{style:y.stickyCopyContainer},r.a.createElement(h.b,{style:y.stickyCopy},i.a))})),y=p.a.create((e=>({stickyCopyContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:1},stickyCopy:{color:e.colors.gray700,padding:e.spaces.space20}})))},pXKu:function(e,t,a){"use strict";var n=a("KEM+"),r=a.n(n),l=a("ERkP"),s=a.n(l),i=a("BUB3"),o=a("v6aA"),c=a("xZGM"),d=a("rxPX");var u=Object(d.a)().propsFromState((()=>({shouldShowPrompt:(e,t)=>Object(c.z)(e,c.j)}))).propsFromActions((()=>({addFlag:c.w}))).withAnalytics({component:"dm_education_flags_prompt"}),h=a("fs1G"),p=a("t62R"),m=a("feu+"),g=a("3XMw"),b=a.n(g);const y=b.a.fd6150fc,_=s.a.createElement(b.a.I18NFormatMessage,{$i18n:"iac7f92a"},s.a.createElement(p.b,{link:"/privacy"},b.a.d42d239f)),E=b.a.j24c37b2;var v=u((e=>{const{addFlag:t,analytics:a,shouldShowPrompt:n}=e,{featureSwitches:r}=s.a.useContext(o.a);if(!(n&&r.isTrue("dm_education_flags_prompt")))return!1;return a.scribeAction("impression"),s.a.createElement(m.a,{actionLabel:E,headline:y,onAction:()=>{a.scribeAction("click"),t(c.j)},onClose:h.a,subtext:_,withCloseButton:!1})})),f=a("MMRb"),S=a("kGix"),I=a("0KEI");var k=Object(d.a)().propsFromState((()=>({hasConversations:f.selectHasConversations,fetchStatus:f.selectFetchStatus,isLoadingTop:f.selectIsLoadingTop}))).adjustStateProps((({fetchStatus:e,hasConversations:t,isLoadingTop:a})=>({fetchStatus:t?S.a.LOADED:e,isRefreshing:t&&a}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(I.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX"),fetchInbox:f.fetchInbox,fetchInboxIfNeeded:f.fetchInboxIfNeeded,fetchUpdates:f.fetchUpdatesIfNeeded}))),C=(a("MvUL"),a("HPNB")),x=a("EbOo"),w=a("tZH3"),F=a("1YZw"),M=a("hqKg"),T=a("AQOc"),L=a("G6rE"),D=a("oEGd");const R=(e,t)=>t.conversationId,O=Object(M.createSelector)(R,((e,t)=>f.selectConversation(e,R(0,t))),f.selectEntries,L.e.selectAll,((e,t)=>!f.selectConversationIsRead(e,R(0,t))),((e,t)=>{const a=R(0,t);return Object(f.selectInboxTypeByConversation)(e,a)}),((e,t)=>Object(c.z)(e,c.r)),((e,t,a,n,r,l,s)=>({conversation:(null==t?void 0:t.data)&&Object(T.a)(t.data,a,n),conversationId:e,unread:r,inboxType:l,shouldShowPinnedEducation:s}))),P={addFlag:c.w,addRecentSearch:f.addRecentSearches,addToast:F.b,block:L.e.block,createLocalApiErrorHandler:Object(I.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_INBOX_ITEM"),disableNotifications:f.disableNotifications,enableNotifications:f.enableNotifications,leaveConversation:f.leaveConversation,muteDMUser:f.muteDMUser,unmuteDMUser:f.unmuteDMUser,unblock:L.e.unblock};var H=Object(D.g)(O,P),A=a("aA19"),N=a("OhSZ"),K=a("V/6K"),B=a("g54k");const U=(e,t)=>t.entry;var j=Object(d.a)().propsFromState((()=>({users:Object(M.createSelector)(L.e.selectAll,U,B.b)}))).adjustStateProps((({users:e})=>({...e}))),V=a("zQEV");var z=j((({entry:e,entryType:t,perspective:a,users:n})=>{const r=Object(V.a)(e,t,a,n);return s.a.createElement(p.b,{color:"gray700"},r)}));const q=Object(M.createSelector)(((e,t)=>L.e.select(e,t.senderId)),((e,t)=>t.recipientId?L.e.select(e,t.recipientId):void 0),((e,t)=>({user:e,recipient:t})));var G=Object(D.c)(q),W=a("X/yg"),Q=a("cTG8");const $=e=>s.a.createElement(b.a.I18NFormatMessage,{$i18n:"b3a2b11c"},s.a.createElement(p.b,null,e)),X=b.a.dedfd265;const Y=b.a.a876e58b,Z=b.a.bf584cd1,J=b.a.a9cc8cfd,ee=b.a.e20b65b0,te=b.a.e5bfe07d,ae=b.a.b1a614fe;var ne=G((({entry:e,perspective:t,isGroupDM:a,user:n={},recipient:r={}})=>{const{featureSwitches:l}=s.a.useContext(o.a),i=e&&e.message_data;if(!i)return null;const{attachment:c}=i,d=c&&!!(c.video||c.photo||c.animated_gif||c.tweet||c.fleet||c.sticker||c.card),u=t===n.id_str,h=!(!d||!u)||!(!a||u),m=n.name,g=r.name;let y=[h&&s.a.createElement(p.b,{key:"senderName"},$(m)," "),i&&i.text&&s.a.createElement(Q.a,{displayTextRange:[0,i.text.length],entities:i.entities,key:"message",text:i.text,withMediaLinks:!0})];return c&&(c.tweet?y=h?((e,t)=>e?s.a.createElement(p.b,null,b.a.d5b762c8):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"dfd2b3b9"},s.a.createElement(p.b,null,t)))(u,m):ae:c.fleet?y=((e,t,a)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"i005f1fd"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a||"")):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"b35cee40"},s.a.createElement(p.b,null,a||"")))(u,g,i.text):c.video?y=Object(W.k)(c,l)?h?function(e,t){return e?s.a.createElement(p.b,null,b.a.h7033cac):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"be5a9616"},s.a.createElement(p.b,null,t))}(u,m):X:h?((e,t)=>e?s.a.createElement(p.b,null,b.a.j7d81019):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"eee2f120"},s.a.createElement(p.b,null,t)))(u,m):Y:c.photo?y=h?((e,t)=>e?s.a.createElement(p.b,null,b.a.f80629ba):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"c1e1f848"},s.a.createElement(p.b,null,t)))(u,m):Z:c.animated_gif?y=h?((e,t)=>e?s.a.createElement(p.b,null,b.a.eb3d722e):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"dc4b75a1"},s.a.createElement(p.b,null,t)))(u,m):J:c.sticker?y=h?((e,t)=>e?s.a.createElement(p.b,null,b.a.d30c2d4f):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"c7e2464e"},s.a.createElement(p.b,null,t)))(u,m):ee:c.card&&(y=h?((e,t)=>e?s.a.createElement(p.b,null,b.a.db53c017):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"hcbbbb34"},s.a.createElement(p.b,null,t)))(u,m):te)),s.a.createElement(p.b,{color:"gray700",numberOfLines:1},y)})),re=a("uKEd");const le=(e,t)=>t.senderId?L.e.select(e,t.senderId):void 0,se=(e,t)=>Object(re.n)(e,t.reactionEntry.message_id),ie=(e,t)=>{const a=se(e,t);return a&&a.message_data&&L.e.select(e,a.message_data.sender_id)};var oe=Object(D.e)((()=>Object(M.createSelector)(le,se,ie,((e,t,a)=>({reactedMessageEntry:t,reactingUser:e,messageUser:a})))),{}),ce=a("33Kz");var de=oe((({isGroupDM:e,messageUser:t,perspective:a,reactedMessageEntry:n,reactingUser:r,reactionEntry:l})=>{const{featureSwitches:i}=s.a.useContext(o.a),c=n&&n.message_data,d=c&&c.attachment,u=c&&c.text,h=t&&t.screen_name,m=a===(r&&r.id_str),g=r&&r.name,y=Object(ce.b)(l.reaction_key||"",i);let _;return _=d&&d.tweet?e?((e,t,a,n)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"c4202784"},s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"b493a890"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)))(m,g,h,y):((e,t,a)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"ca684bf5"},s.a.createElement(p.b,null,a)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"h5797be5"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a)))(m,g,y):d&&d.video?e?((e,t,a,n)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"d1f8bdd9"},s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"d764af97"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)))(m,g,h,y):((e,t,a)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"ab1cdfe2"},s.a.createElement(p.b,null,a)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"f0cf1699"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a)))(m,g,y):d&&d.photo?e?((e,t,a,n)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"hec0fd4d"},s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"j55320de"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)))(m,g,h,y):((e,t,a)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"jf27606a"},s.a.createElement(p.b,null,a)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"cd110359"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a)))(m,g,y):d&&d.animated_gif?e?((e,t,a,n)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"e70dcc35"},s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"g1bf440b"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)))(m,g,h,y):((e,t,a)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"b2da1bf8"},s.a.createElement(p.b,null,a)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"g84c0421"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a)))(m,g,y):d&&d.card?e?((e,t,a,n)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"cd2e7c18"},s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"aee9e7fa"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)))(m,g,h,y):((e,t,a)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"f9fb1cf6"},s.a.createElement(p.b,null,a)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"f2bf910e"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a)))(m,g,y):u?e?((e,t,a,n,r)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"i6cec545"},s.a.createElement(p.b,null,n),s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,r)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"d6998baa"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,n),s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,r)))(m,g,y,h,u):((e,t,a,n)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"cec676f3"},s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"a2706f9a"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a),s.a.createElement(p.b,null,n)))(m,g,y,u):((e,t,a)=>e?s.a.createElement(b.a.I18NFormatMessage,{$i18n:"d6b15bbf"},s.a.createElement(p.b,null,a)):s.a.createElement(b.a.I18NFormatMessage,{$i18n:"ac0d4bc7"},s.a.createElement(p.b,null,t),s.a.createElement(p.b,null,a)))(m,g,y),s.a.createElement(p.b,{color:"gray700",numberOfLines:1},_)})),ue=a("H4nC"),he=a("b9JY");const pe=b.a.fb3ccb55;var me=({conversationType:e,entry:t,perspective:a})=>{if(t.marked_as_spam)return s.a.createElement(p.b,{color:"gray700",numberOfLines:1},pe);if(Object(he.b)(t)){const{message_data:{recipient_id:n,sender_id:r}={}}=t;return s.a.createElement(ne,{entry:t,isGroupDM:e===f.CONVERSATION_TYPE.GROUP,perspective:a,recipientId:n,senderId:r})}return Object(he.c)(t)?s.a.createElement(de,{isGroupDM:e===f.CONVERSATION_TYPE.GROUP,perspective:a,reactionEntry:t,senderId:t.sender_id}):Object(he.a)(t)?s.a.createElement(z,{entry:t,entryType:t.type,perspective:a}):Object(he.d)(t)?s.a.createElement(ue.a,{entry:t,isCompact:!0}):null},ge=a("Myq3"),be=a("3wZR"),ye=a("XnpN"),_e="conversation",Ee=a("u0B7"),ve=a("MWbm"),fe=a("Irs7"),Se=a("eb3s"),Ie=a("ZToW"),ke=a("cHvH"),Ce=a("lHOd"),xe=a("kb9v"),we=a("IG7M"),Fe=a("mjJ+"),Me=a("Znyr"),Te=a("0PHd"),Le=a("yrzJ"),De=a("Xrkv"),Re=a("efqG"),Oe=a("/yvb"),Pe=a("GBcw"),He=a("cm6r"),Ae=a("htQn"),Ne=a("5mJL"),Ke=a("rHpw"),Be=a("vMjK"),Ue=a("AQ79"),je=a("pHkl"),Ve=a("aWyx"),ze=a("Lsrn"),qe=a("k/Ka");const Ge=(e={})=>Object(qe.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[ze.a.root,e.style],viewBox:"0 0 24 24"},s.a.createElement("g",null,s.a.createElement("path",{d:"M17.931 2.508c0 .42-.34.75-.75.75h-8.39l1.38 2.08-.56 5.78-.47.16c-1.5.49-3.1 2.07-3.37 3.31-.07.35-.39.59-.73.59-.05 0-.11 0-.16-.01-.4-.09-.66-.49-.58-.89.39-1.81 2.24-3.52 3.91-4.25l.42-4.3-1.35-2.02c-.26-.38-.29-.87-.07-1.29.24-.41.66-.66 1.11-.66h8.86c.41 0 .75.34.75.75zm3.09 12.76c-.14.17-.46.46-1.05.46h-3.86l-2.64 6.1c-.12.28-.39.45-.69.45s-.57-.17-.69-.45l-1.96-4.53c-.16-.38.01-.82.39-.98.38-.17.82.01.99.39l1.27 2.93 1.69-3.91h-1.61c-.42 0-.75-.33-.75-.75 0-.41.33-.75.75-.75h6.81c-.41-1.06-1.64-2.26-2.91-2.82-.09-.04-.16-.09-.22-.16-.22-.21-.3-.54-.17-.83.17-.38.61-.55.99-.39 1.59.7 3.5 2.43 3.89 4.25.06.25.03.66-.23.99zm.839-12.259L3.2 21.659c-.15.15-.34.22-.53.22s-.39-.07-.53-.22c-.29-.29-.29-.76 0-1.06L20.8 1.939c.29-.29.76-.29 1.06 0 .29.3.29.77 0 1.07z"})));Ge.metadata={width:24,height:24};var We=Ge,Qe=a("ShJ/");const $e=(e={})=>Object(qe.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[ze.a.root,e.style],viewBox:"0 0 32 32"},s.a.createElement("g",null,s.a.createElement("path",{d:"M28.05 6.52h-5.42V4.887c0-1.548-1.26-2.808-2.81-2.808h-7.54c-1.548 0-2.807 1.26-2.807 2.808v1.63H4.05c-.414 0-.75.337-.75.75s.336.75.75.75h.753L7 26.435c.27 1.504 1.657 2.554 3.37 2.554h11.36c1.713 0 3.1-1.05 3.376-2.598l2.19-18.37h.753c.413 0 .75-.337.75-.75s-.336-.75-.75-.75zM10.972 4.887c0-.72.586-1.308 1.307-1.308h7.542c.72 0 1.308.587 1.308 1.308v1.63H10.972V4.89zm12.65 21.28c-.163.91-1.068 1.32-1.893 1.32H10.37c-.824 0-1.73-.41-1.887-1.276L6.313 8.02h19.472l-2.162 18.148z"}),s.a.createElement("path",{d:"M13.312 23.123c.414 0 .75-.336.75-.75v-9.6c0-.414-.336-.75-.75-.75s-.75.336-.75.75v9.6c0 .414.336.75.75.75zm5.486 0c.414 0 .75-.336.75-.75v-9.6c0-.414-.336-.75-.75-.75s-.75.336-.75.75v9.6c0 .414.336.75.75.75z"})));$e.metadata={width:32,height:32};var Xe=$e,Ye=a("zIWA"),Ze=a("5pef");const Je=(e={})=>Object(qe.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[ze.a.root,e.style],viewBox:"0 0 24 24"},s.a.createElement("g",null,s.a.createElement("path",{d:"M22.238 2.257c-.293-.293-.768-.293-1.06 0L2.52 20.917c-.293.292-.293.767 0 1.06.146.146.338.22.53.22s.384-.073.53-.22l18.658-18.66c.293-.293.293-.767 0-1.06zM2.986 17.82c.155 0 .312-.048.446-.148.112-.083 2.752-2.104 2.708-7.248-.02-2.16.643-3.98 1.913-5.266 1.093-1.107 2.577-1.72 4.18-1.727 1.325.006 2.562.42 3.578 1.195.137.104.297.153.455.153.227 0 .45-.102.598-.295.25-.33.188-.8-.142-1.052-1.278-.975-2.828-1.493-4.483-1.5h-.003c-2.008.008-3.87.78-5.248 2.173-1.536 1.551-2.368 3.8-2.348 6.332.037 4.33-2.02 5.967-2.103 6.03-.332.247-.4.718-.154 1.05.147.2.374.303.603.303zm16.844-7.382c.002-.246-.003-.487-.017-.723-.024-.414-.387-.74-.792-.706-.413.023-.728.378-.705.79.012.205.017.413.015.624-.024 2.868.785 4.765 1.526 5.896h-8.314c-.414 0-.75.336-.75.75s.336.75.75.75h3.522c-.1 1.48-1.323 2.66-2.828 2.66-1.003 0-1.913-.514-2.436-1.372-.214-.354-.675-.467-1.03-.25-.354.214-.467.675-.25 1.03.795 1.31 2.185 2.09 3.716 2.09 2.332 0 4.227-1.85 4.328-4.158h4.922c.32 0 .604-.206.707-.51.104-.305 0-.643-.255-.84-.087-.066-2.145-1.7-2.108-6.032z"})));Je.metadata={width:24,height:24};var et=Je,tt=a("5oT/");const at=b.a.d88d0790,nt=b.a.ad63377d,rt={confirmButtonLabel:b.a.bb1d57b6,actionTextLeave:b.a.g9074da4,header:b.a.gdf4b79f,text:b.a.h09b49f7},lt=b.a.e1c9ec9b,st=b.a.i6b19b07,it=b.a.e3cfff7c,ot=b.a.a8ed0eca,ct=b.a.bdd91963,dt=b.a.a30a206d,ut=b.a.ib4b1b85,ht=b.a.bd3ca2ee,pt={component:"low_quality_timeline"},mt=({children:e})=>s.a.createElement(ve.a,{style:bt.socialProofContainer},e);class gt extends s.a.Component{constructor(...e){super(...e),r()(this,"_count",this.context.featureSwitches.getValue("dm_conversation_labels_max_pinned_count")),r()(this,"_isPinnedInboxEnabled",this.context.featureSwitches.isTrue("dm_conversation_labels_pinned_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1")),r()(this,"_isVDLEnabled",this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled")),r()(this,"state",{showActionMenu:!1,showConfirmation:!1}),r()(this,"_renderConfirmationSheet",(()=>{const{conversationId:e}=this.props;return s.a.createElement(Se.a,{confirmButtonLabel:rt.confirmButtonLabel,confirmButtonType:"destructiveFilled",headline:rt.header,onCancel:this._handleHideConfirmation,onConfirm:this._deleteConversation(e),text:rt.text})})),r()(this,"_renderMenu",(({isFocused:e,isFocusedWithin:t,isHovered:a})=>{var n;const{showActionMenu:r}=this.state,{addFlag:l,conversation:i,position:o,shouldShowPinnedEducation:d}=this.props,u=i&&(null==i||null===(n=i.labels)||void 0===n?void 0:n.find((e=>e.label_type===Ue.a.PINNED))),h=()=>{l(c.r)},p=()=>{this.setState({showActionMenu:!0})},m=d&&1===o&&!u,g=!Ie.a.isEnabled||e||t||a||r||m;return s.a.createElement(K.a.Consumer,null,(({isDrawer:e})=>s.a.createElement(ke.a,null,(({windowWidth:t})=>{const a=C.a.isTwoColumnLayout(t);return s.a.createElement(Ce.a.Consumer,null,(t=>s.a.createElement(s.a.Fragment,null,s.a.createElement(xe.a,{actionPrimary:{text:dt,onClick:h},headline:ut,onDismiss:h,shouldDisplay:m&&!e,text:ht({count:this._count}),withMask:!a},a?s.a.createElement(we.a,{onClick:p,renderActionMenu:this._renderActionMenu,style:g?bt.menu:bt.hiddenMenu}):null),a?null:s.a.createElement(we.a,{onClick:p,renderActionMenu:this._renderActionMenu,style:g?bt.menu:bt.hiddenMenu}))))}))))})),r()(this,"_renderActionMenu",(e=>{var t;const{conversation:a,conversationId:n,togglePinState:r}=this.props,{history:l}=this.context,i=a&&(null==a||null===(t=a.labels)||void 0===t?void 0:t.find((e=>e.label_type===Ue.a.PINNED))),o=null==a?void 0:a.notifications_disabled,c=[];if(a){if(r){const e={Icon:i?We:Qe.a,onClick:()=>r(n,a),text:i?ct:lt,withBottomBorder:!0};c.push(e)}const e={Icon:Xe,isEmphasized:!0,onClick:this._handleDeleteMenuItemClick,text:nt,withBottomBorder:!0},t={Icon:Ye.a,onClick:()=>this._handleReportMenuItemClick(l)(),text:st,withBottomBorder:!0},s={Icon:o?Ze.a:et,onClick:()=>this._handleSnoozeMenuItemClick(n),text:o?ot:it,withBottomBorder:!0};c.push(t,s,e)}return s.a.createElement(Fe.a,{items:c,onCloseRequested:this._handleHideMenu(e),shouldCloseOnClick:!0})})),r()(this,"_renderConversationActions",(({isFocused:e,isFocusedWithin:t,isHovered:a})=>{const{inboxType:n}=this.props;switch(n){case Ue.d.PRIMARY:return this._isPinnedInboxEnabled?this._renderMenu({isFocused:e,isFocusedWithin:t,isHovered:a}):null;case Ue.d.SECONDARY:case Ue.d.TERTIARY:return this._renderX();default:return null}})),r()(this,"_renderConversationEndCell",(e=>{const{inboxType:t,searchQuery:a,unread:n}=this.props,r=n?s.a.createElement(Me.a,{pip:!0,style:bt.unreadMessagePip,truncatedCountFormatter:()=>"",unreadCountLabel:()=>""}):null;switch(t){case Ue.d.PRIMARY:return this._isVDLEnabled?r:a?null:this._renderTimestamp(e);case Ue.d.SECONDARY:return this._isVDLEnabled?r:null;default:return null}})),r()(this,"_renderConversationLabel",(({convo_label:e})=>{if(null==e||!e.text)return null;const t=Object(be.b)(e.icon);return s.a.createElement(p.b,{color:"gray700",size:"subtext2"},t?s.a.createElement(t,{style:bt.convoLabelIcon}):null,e.text)})),r()(this,"_renderSocialProof",(({social_proof:e})=>{if(!e||0===e.length)return null;const t=e[0];switch(t.proof_type){case Ve.d.MUTUAL_FRIENDS:{if(0===t.total)return null;const e=t.users.map((({profile_image_url_https:e})=>e)),a=t.users.map((({name:e})=>e)),n=this._isVDLEnabled?{marginLeft:0}:null;return s.a.createElement(mt,null,s.a.createElement(Te.a,{displayFacepileInline:!0,knownFollowersAvatarUrls:e,knownFollowersCount:t.total,knownFollowersNames:a,textStyle:n,withFacepile:!this._isVDLEnabled}))}default:return null}})),r()(this,"_renderSearchConversationPreview",(()=>{const{conversation:e,perspective:t,searchQuery:a}=this.props,n=e?Object(ye.a)(e,t):[],r=[],l=(e,t)=>e.localeCompare(t),i=n.map((({user:e})=>e)).filter((e=>{var n;const l=null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(a);return e.id_str!==t&&(l&&r.push(e.name),!l)})).map((e=>e.name)).sort(l),o=r.sort(l).concat(i);if(e){if(e.type===f.CONVERSATION_TYPE.ONE_TO_ONE){const[e]=n.map((({user:e})=>e));return s.a.createElement(Le.a,{color:"gray700",screenName:e.screen_name})}{const e=!0,t=Object(De.a)(o,e);return s.a.createElement(p.b,{color:"gray700",numberOfLines:2},t)}}})),r()(this,"_renderX",(()=>{const{conversation:e,conversationId:t}=this.props,{loggedInUserId:a}=this.context,n=Object(W.i)(e,a),r=(null==e?void 0:e.type)===f.CONVERSATION_TYPE.GROUP;return s.a.createElement(Ce.a.Consumer,null,(e=>s.a.createElement(Re.a,{renderContent:(a,l)=>s.a.createElement(w.a,{dismiss:a,flatBorders:"sheet"===l,isGroup:r,onBlockClick:this._blockUser(n.idStr),onDeleteClick:this._deleteConversation(t),onReportClick:this._handleReportMenuItemClick(e),requestorScreenName:n.screenName,showBlock:!r,showCancel:"sheet"===l,showDelete:!0})},s.a.createElement(Oe.a,{accessibilityLabel:at,icon:s.a.createElement(tt.a,{style:this._isVDLEnabled?bt.xIcon:void 0}),onPress:this._handleXPress,style:this._isVDLEnabled?bt.vdlXButton:bt.xButton,type:this._isVDLEnabled?void 0:"destructiveText"}))))})),r()(this,"_handleDeleteMenuItemClick",(()=>{this.setState({showConfirmation:!0})})),r()(this,"_handleHideMenu",(e=>()=>{e&&e(),this.setState({showActionMenu:!1})})),r()(this,"_handleReportMenuItemClick",(e=>()=>{const{analytics:t,conversationId:a,inboxType:n}=this.props;if(a){t.scribeAction("report");const r=Object(W.f)(a,window.location.pathname,t.contextualScribeNamespace,n);e.push(r)}})),r()(this,"_handleSnoozeMenuItemClick",(e=>{const{conversation:t,disableNotifications:a,enableNotifications:n}=this.props;(null==t?void 0:t.notifications_disabled)?n({conversationId:e}):a({conversationId:e})})),r()(this,"_handleXPress",(e=>{e.preventDefault()})),r()(this,"_renderTimestamp",(e=>{const{conversation:t,isMessageItem:a}=this.props,n=this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled"),r=[n||a?bt.inlineNotificationsDisabledIcon:bt.notificationsDisabledIcon],l=Number(e&&a?null==e?void 0:e.time:null==t?void 0:t.sort_timestamp);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ve.a,{style:(n||a)&&bt.inlineTimestamp},t&&l?s.a.createElement(Pe.a,{timestamp:l}):null,null!=t&&t.notifications_disabled?s.a.createElement(et,{style:r}):null))})),r()(this,"_deleteConversation",(e=>()=>{const{analytics:t,conversation:a,createLocalApiErrorHandler:n,inboxType:r,leaveConversation:l,position:s}=this.props,{history:i}=this.context,o=null!=a&&a.participants?Object.keys(a.participants).length:0,c=a&&a.type===f.CONVERSATION_TYPE.GROUP?"leave_group":"delete_thread",d={conversation_type:(null==a?void 0:a.type)===f.CONVERSATION_TYPE.GROUP?1:0,conversation_id:e,conversation_participant_count:o,position:s,inbox_type:Object(W.h)(r),entry_point:je.b.CELL_X_BUTTON};this._handleHideConfirmation(),t.scribe({element:"thread",action:c,data:d}),l({conversationId:e}).catch(n({showToast:!0})),i.replace(Object(W.e)(r))})),r()(this,"_blockUser",(e=>()=>{const{addToast:t,analytics:a,block:n,createLocalApiErrorHandler:r}=this.props;n(e).then((()=>{t({action:{label:Be.c,onAction:this._createUnblockUserHandler(e)},text:Be.a})}),r(x.a)),a.scribeAction("block")})),r()(this,"_createUnblockUserHandler",(e=>()=>{const{analytics:t,createLocalApiErrorHandler:a,unblock:n}=this.props;n(e).catch(a(Ee.a)),t.scribeAction("unblock")})),r()(this,"_handleHideConfirmation",(()=>{this.setState({showConfirmation:!1})})),r()(this,"_handleOnClick",(e=>{const{addRecentSearch:t,analytics:a,conversation:n,conversationId:r,onClick:l,position:s,searchQuery:i}=this.props,o=null!=n&&n.participants?Object.keys(n.participants).length:0,c=(null==n?void 0:n.type)===f.CONVERSATION_TYPE.GROUP;i&&(a.scribe({component:"search",element:"conversation",action:"click",data:{conversation_id:r,conversation_participant_count:o,conversation_type:c?je.g.GROUP:je.g.ONE_TO_ONE,entry_point:je.b.ALL,inbox_type:je.c.PRIMARY,dm_search_result_type:je.a.CONVERSATION,message_type:je.d.NOT_APPLICABLE,position:s}}),a.scribe({component:"recent_search",action:"add"}),t(i)),l(e,r,n,s)})),r()(this,"_handleShowConfirmation",(e=>{const{analytics:t}=this.props;e.stopPropagation(),t.scribe({...pt,element:"accessory_trashcan",action:"click"}),this.setState({showConfirmation:!0})}))}shouldComponentUpdate(e,t){const a=this.props.conversation,n=null==a?void 0:a.conversation_id,r=null==a?void 0:a.notifications_disabled,l=null==a?void 0:a.last_read_event_id,s=null==a?void 0:a.sort_event_id,i=null==a?void 0:a.max_entry_id,o=null==a?void 0:a.convo_label,c=this.props.messageId,d=this.props.shouldShowPinnedEducation,u=e.conversation,h=null==u?void 0:u.conversation_id,p=null==u?void 0:u.notifications_disabled,m=null==u?void 0:u.last_read_event_id,g=null==u?void 0:u.sort_event_id,b=null==u?void 0:u.max_entry_id,y=null==u?void 0:u.convo_label,_=e.messageId,E=e.shouldShowPinnedEducation,{filter:v,isActive:f}=this.props,{filter:S,isActive:I}=e,{showConfirmation:k}=this.state,{showConfirmation:C}=t;return n!==h||r!==p||l!==m||s!==g||i!==b||c!==_||f!==I||k!==C||v!==S||o!==y||d!==E}render(){const{conversation:e,isActive:t,isMessageItem:a,link:n,messageId:r,perspective:l,position:i,searchQuery:o,unread:c}=this.props,{showConfirmation:d}=this.state,u=(null==e?void 0:e.entries)||[],h=a?u.find((e=>e.id===r)):Object(ge.a)(u,(e=>![Ve.b.MESSAGE_DELETE,Ve.b.REACTION_DELETE,Ve.b.MESSAGE_MARK_AS_SPAM,Ve.b.MESSAGE_MARK_AS_NOT_SPAM,Ve.b.CONVO_METADATA_UPDATE,Ve.b.DISABLE_NOTIFICATIONS,Ve.b.ENABLE_NOTIFICATIONS].includes(e.type))),p=[bt.root,c&&!this._isVDLEnabled&&bt.unread],m=(null==e?void 0:e.type)===f.CONVERSATION_TYPE.GROUP,g=this._isVDLEnabled&&m;if(!e)return null;const b=!!e.convo_label,y=!e.trusted&&!b,_=this._isVDLEnabled?"xxxLarge":"xxLarge",E=this._renderConversationEndCell(h),v=o&&!a;return!e||!o&&e.isSearchResultOnly?null:s.a.createElement(s.a.Fragment,null,d?this._renderConfirmationSheet():null,s.a.createElement(He.a,null,(({isFocused:r,isFocusedWithin:c,isHovered:d})=>s.a.createElement(Ae.a,{accessibilityRole:"tab",accessibilityState:{selected:t},link:{pathname:null==n?void 0:n.pathname,anchorless:!0,state:{...null==n?void 0:n.state,position:i}},onPress:this._handleOnClick,style:p,testID:_e},s.a.createElement(Ne.a,{avatarCell:s.a.createElement(A.a,{conversation:e,perspective:l,withBadge:g,withVDLRefresh:this._isVDLEnabled}),avatarSize:_},s.a.createElement(ve.a,{style:bt.bodyColumn},s.a.createElement(ve.a,{style:bt.titleContainer},s.a.createElement(N.b,{conversation:e,isConversationSearchTitle:!!v,isMessageSearchTitle:!!a,perspective:l,renderTimestamp:()=>this._renderTimestamp(h),withScreenName:!o&&!a,withVDLRefresh:this._isVDLEnabled}),s.a.createElement(ve.a,{style:bt.snippet},h&&!v?s.a.createElement(me,{conversationType:e.type,entry:h,isMessageItem:a,perspective:l}):v?this._renderSearchConversationPreview():null),b?this._renderConversationLabel(e):null,y?this._renderSocialProof(e):null),E?s.a.createElement(ve.a,{style:bt.endCell},E):null,this._renderConversationActions({isFocused:r,isFocusedWithin:c,isHovered:d})))))))}}r()(gt,"contextType",o.a),r()(gt,"defaultProps",{searchQuery:"",inboxType:"primary",isActive:!1,filter:e=>!0});const bt=Ke.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16,width:"100%"},bodyColumn:{flexDirection:"row"},inlineTimestamp:{flexDirection:"row"},titleContainer:{flex:1},inlineNotificationsDisabledIcon:{paddingLeft:`calc(${e.spaces.space2} * 3)`,color:e.colors.gray700},hiddenMenu:{opacity:0,overflow:"hidden",width:0},menu:{alignSelf:"flex-start",marginLeft:`calc(${e.spaces.space8} + ${e.spaces.space2})`},notificationsDisabledIcon:{alignSelf:"flex-end",color:e.colors.gray700,paddingTop:e.spaces.space4},unreadMessagePip:{backgroundColor:e.colors.blue500,marginTop:`calc(${e.spaces.space8} - ${e.spaces.space1})`},vdlXButton:{border:"none",marginLeft:`calc(${e.spaces.space8} + ${e.spaces.space2})`,marginRight:`calc(-1 * ${e.spaces.space4})`,marginTop:`calc(-1 * (${e.spaces.space8} - ${e.spaces.space1}))`},xButton:{alignSelf:"center",marginRight:`calc(-1 * ${e.spaces.space4})`},xIcon:{height:`calc(${e.spaces.space28} - ${e.spaces.space1})`,width:`calc(${e.spaces.space28} - ${e.spaces.space1})`},trashcanIcon:{color:e.colors.gray700},snippet:{maxHeight:e.spaces.space40,overflow:"hidden"},unread:{backgroundColor:e.colors.unreadCellBackground},socialProofContainer:{marginTop:e.spaces.space4},convoLabelIcon:{marginRight:e.spaces.space4},endCell:{marginLeft:e.spaces.space16}})));var yt=Object(fe.a)(H(gt),{page:"messages",section:"inbox"});var _t=Object(d.a)().propsFromState((()=>({pinnedConversationIds:f.selectPinnedConversationIds}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(I.createLocalApiErrorHandlerWithContextFactory)("DM_PINNED_INBOX_CONTEXT")}))),Et=a("oUUt");const vt=b.a.b08821f3,ft=b.a.e047b8fa,St=Ke.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,paddingLeft:e.spaces.space16,paddingVertical:e.spaces.space4,alignItems:"center",flexDirection:"row",justifyContent:"space-between",borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor},backButton:{marginRight:e.spaces.space4},iconContainer:{alignItems:"center",flexDirection:"row"},icon:{color:e.colors.text,marginRight:e.spaces.space12,fontSize:e.fontSizes.body,marginVertical:e.spaces.space8},labelHeader:{borderBottomStyle:"none",paddingVertical:e.spaces.space12}})));var It=e=>{const t=Object(fe.b)(),{clearRecentSearches:a,headerText:n,icon:r,isInboxLabelHeader:l,withClearButton:i}=e;s.a.useEffect((()=>{t.scribe({component:"recent_search",action:"impression"})}),[t]);const o=[St.root,l&&St.labelHeader];return s.a.createElement(ve.a,{style:o},s.a.createElement(ve.a,{style:St.iconContainer},(()=>{const e=r;return e?s.a.createElement(e,{style:St.icon}):null})(),s.a.createElement(p.b,{size:"headline1",weight:"heavy"},n)),i?s.a.createElement(Oe.a,{accessibilityLabel:vt,onPress:a,style:St.backButton,type:"onMediaWhiteFilled"},ft):null)},kt=a("h3MB"),Ct=(a("enFi"),a("xPna"));const xt=(e,t=!0)=>{const a={};let n={};return null!=e&&e.conversations&&(Object.values(e.conversations).forEach((e=>{e&&e.users&&Object.assign(a,e.users),t&&(e.isSearchResult=!0)})),n={conversations:null==e?void 0:e.conversations,users:a}),null!=e&&e.entries&&(n={...n,entries:null==e?void 0:e.entries}),Object(Ct.a)(n)};var wt=a("VPAj");var Ft={...a("7n04").a,initialScrollHeadroom:Object(wt.a)(0),scrollHeadroom:Object(wt.a)(0),pinToNewestWhenAtNewest:!0},Mt=a("TEoO"),Tt=a("NjAB"),Lt=a("OIs+");const Dt=b.a.e4f6bd9e,Rt=b.a.e4ff75a9,Ot={[Lt.a.Offline]:{toast:{text:Rt}},defaultToast:{text:Dt},showToast:!0};var Pt,Ht,At,Nt=a("Fr3L"),Kt=a("uDfI"),Bt=a("9SqB"),Ut=a.n(Bt),jt=a("DQzJ");const Vt=b.a.e4b3f520,zt=b.a.ae4d666a,qt=e=>e,Gt=b.a.a219e217,Wt=b.a.d571e4f8,Qt=b.a.a551bf7d,$t=void 0!==Pt?Pt:Pt=a("X8um"),Xt={context:"DM_PINNED_INBOX"},Yt=e=>{var t;const n=Object(Kt.c)(),{accessibilityTitle:r,cacheKey:l,conversationIds:i,createLocalApiErrorHandler:c,footer:d,header:u,onNearEnd:h,pinnedConversationIds:p,renderEmptyDMInbox:m,renderInboxItem:g,withKeyboardShortcuts:b}=e,{data:y}=Object(jt.a)($t,{label:Ue.a.PINNED}),_=c(Ot),[E,v]=s.a.useState(!1),{featureSwitches:f}=s.a.useContext(o.a),S=f.getValue("dm_conversation_labels_max_pinned_count"),I=(null==y||null===(t=y.labeled_conversation_slice)||void 0===t?void 0:t.items)||[],{entities:k}=Object(Tt.b)(I,[kt.a]);s.a.useEffect((()=>{n(xt(k))}),[y]);const[C]=Ut()(void 0!==Ht?Ht:Ht=a("ZH9U")),[x]=Ut()(void 0!==At?At:At=a("rQjK")),w=(e,t)=>{x({variables:{conversation_id:e,label_type:Ue.a.PINNED},onCompleted(a){var r;const l=Object(ye.a)(t),s=t?null==t||null===(r=t.labels)||void 0===r?void 0:r.filter((e=>e.label_type!==Ue.a.PINNED)):[];n(xt({conversations:{[e]:{...t,participants:l,labels:s}}}))},updater(t){var a,n;const r=null===(a=I.find((t=>t.rest_id===e)))||void 0===a?void 0:a.id,l=null==y||null===(n=y.labeled_conversation_slice)||void 0===n?void 0:n.__id;if(!r||!l)return;const s=t.get(r),i=t.get(l);i&&s&&(Object(Et.b)(i,r),t.delete(r))},onError(e){_(e)}})},F=null==i?void 0:i.filter((e=>-1===p.indexOf(e))),M=p.length&&F.length,T=s.a.createElement(s.a.Fragment,null,u,null!=p&&p.length?s.a.createElement(s.a.Fragment,null,Zt(Vt),p.map(((e,t)=>g({conversationIds:p,togglePinState:w})(e)))):null,M?Zt(zt):null);return null!=i&&i.length?s.a.createElement(s.a.Fragment,null,E?s.a.createElement(Se.a,{confirmButtonLabel:Gt,headline:Wt({count:S}),onConfirm:()=>v(!1),text:Qt,withCancelButton:!1}):null,l&&null!=F&&F.length?s.a.createElement(Mt.a,{accessibilityRole:"tablist",accessibilityTitle:r,anchoring:Ft,assumedItemHeight:100,cacheKey:l,footer:d,header:T,identityFunction:qt,items:F,onNearEnd:h,renderer:g({conversationIds:F,togglePinState:(e,t)=>{C({variables:{conversation_id:e,label:Ue.a.PINNED},onCompleted(a){var r;switch(null===(r=a.add_dm_conversation_label_v3)||void 0===r?void 0:r.__typename){case"DMConversationLabelInfo":{const{label_type:r,timestamp:l}=a.add_dm_conversation_label_v3,s=Object(ye.a)(t);n(xt({conversations:{[e]:{...t,participants:s,labels:[{label_type:r,timestamp:l}]}}}));break}case"DMConversationLabelUnavailable":{const{failure_reason:e}=a.add_dm_conversation_label_v3;"ExceededMaxPinnedConversations"===e&&v(!0);break}}},onError(e){_(e)}})}}),withKeyboardShortcuts:b,withoutHeadroom:!0}):T,";"):m()},Zt=e=>s.a.createElement(ve.a,null,s.a.createElement(It,{headerText:e,isInboxLabelHeader:!0}));var Jt=_t((function(e){return s.a.createElement(Nt.a,{errorConfig:Xt},s.a.createElement(Yt,e))}));const ea=(e,{module:t})=>t.selectItems(e),ta=(e,{module:t})=>t.selectFetchStatus(e);var aa=Object(d.a)().propsFromState((()=>({fetchStatus:ta,sliceItems:ea}))).adjustStateProps((({fetchStatus:e,sliceItems:t})=>{const a=(e=>{var t;return(null===(t=e.find((e=>e.groupData)))||void 0===t?void 0:t.groupData)||[]})(t),n=(e=>{var t;return(null===(t=e.find((e=>e.peopleData)))||void 0===t?void 0:t.peopleData)||[]})(t),r=(e=>{var t,a;return(null===(t=e.find((e=>e.messageData)))||void 0===t||null===(a=t.messageData)||void 0===a?void 0:a.conversationIds)||[]})(t);return{entryIds:(e=>{var t,a;return(null===(t=e.find((e=>e.messageData)))||void 0===t||null===(a=t.messageData)||void 0===a?void 0:a.entryIds)||[]})(t),fetchStatus:e,groupConversationIds:a,messageConversationIds:r,peopleSearchConversationIds:n,sliceItems:t}})).propsFromActions((({module:e})=>({createLocalApiErrorHandler:Object(I.createLocalApiErrorHandlerWithContextFactory)("DM_SEARCH_ALL_CONTEXT"),fetchSearchIfNeeded:e.fetchIfNeeded}))),na=a("MDbM"),ra=a("v//M"),la=a("0yYu"),sa=a("lBmi"),ia=a("91AQ"),oa=a("6ZHn");const ca=b.a.c94ac69d,da=b.a.a2f8105f,ua=b.a.g2fd3205,ha=b.a.ffd9cfe6;class pa extends s.a.Component{constructor(...e){super(...e),r()(this,"_groupBucketSize",this.context.featureSwitches.getNumberValue("dm_inbox_search_groups_bucket_size")),r()(this,"_messagesBucketSize",this.context.featureSwitches.getNumberValue("dm_inbox_search_messages_bucket_size")),r()(this,"_peopleBucketSize",this.context.featureSwitches.getNumberValue("dm_inbox_search_people_bucket_size")),r()(this,"_renderSearchResults",(()=>{const{groupConversationIds:e,messageConversationIds:t,peopleSearchConversationIds:a,renderEmptyState:n}=this.props,r=a.length&&e.length,l=this._groupBucketSize<e.length,i=this._messagesBucketSize<t.length,o=this._peopleBucketSize<a.length;return(null==e?void 0:e.length)||a.length||t.length?s.a.createElement(s.a.Fragment,null,a.length?this._renderPeopleSection():null,r&&!o?s.a.createElement(la.a,null):null,o?this._renderDMSearchFooter(ua):null,e.length?this._renderGroupsSection():null,l?this._renderDMSearchFooter(ca):null,t.length?this._renderMessagesSection():null,i?this._renderDMSearchFooter(da):null):n()})),r()(this,"_handleFetch",(()=>{const{createLocalApiErrorHandler:e,fetchSearchIfNeeded:t}=this.props;t().catch(e())})),r()(this,"_renderDMSearchFooter",(e=>{const{location:t}=this.props;return s.a.createElement(ve.a,{style:ma.header},s.a.createElement(p.b,{link:{pathname:t.pathname,state:{tab:e}}},ha))})),r()(this,"_renderDMHeader",(({headerText:e,icon:t})=>s.a.createElement(It,{headerText:e,icon:t}))),r()(this,"_renderGroupsSection",(()=>{const{groupConversationIds:e,renderInboxItem:t}=this.props;return s.a.createElement(s.a.Fragment,null,this._renderDMHeader({icon:sa.a,headerText:ca}),e.map((a=>a?t({conversationIds:e})(a):null)).slice(0,this._groupBucketSize))})),r()(this,"_renderMessagesSection",(()=>{const{entryIds:e,messageConversationIds:t,renderInboxItem:a}=this.props;return s.a.createElement(s.a.Fragment,null,this._renderDMHeader({icon:ia.a,headerText:da}),e.map((n=>n?(n=>a({conversationIds:t,isMessageItem:!0,messageIds:e})(n))(n):null)).slice(0,this._messagesBucketSize))})),r()(this,"_renderPeopleSection",(()=>{const{peopleSearchConversationIds:e,renderInboxItem:t}=this.props;return s.a.createElement(s.a.Fragment,null,this._renderDMHeader({icon:oa.a,headerText:ua}),e.map((a=>a?t({conversationIds:e})(a):null)).slice(0,this._peopleBucketSize))}))}componentDidUpdate(e){const{fetchStatus:t,module:a}=this.props;e.module!==a&&t!==na.a.FAILED&&this._handleFetch()}componentDidMount(){this._handleFetch()}render(){const{fetchStatus:e,loadingLabel:t}=this.props;return s.a.createElement(ra.a,{accessibilityLabel:t,fetchStatus:e,onRequestRetry:this._handleFetch,render:this._renderSearchResults})}}r()(pa,"contextType",o.a);const ma=Ke.a.create((e=>({header:{backgroundColor:e.colors.cellBackground,paddingLeft:e.spaces.space16,paddingVertical:e.spaces.space12,alignItems:"center",flexDirection:"row",justifyContent:"space-between",borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,borderTopStyle:"solid",borderTopWidth:e.borderWidths.small,borderTopColor:e.colors.borderColor}})));var ga=aa(pa),ba=a("wAC9");var ya=e=>Object(ba.a)({contextSuffix:"DM_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMAllSearch,sliceKey:`${je.e}-${e}`,getEndpointParams:t=>({...t,query:e}),mapEntitiesToActions:xt});const _a=(e,t)=>t.query;var Ea=Object(d.a)().propsFromState((()=>({sliceModule:Object(M.createSelector)(_a,(e=>e?ya(e):void 0))})))((e=>{const{loadingLabel:t,location:a,query:n,renderEmptyState:r,renderInboxItem:l,sliceModule:i}=e;return i?s.a.createElement(ga,{loadingLabel:t,location:a,module:i,query:n,renderEmptyState:r,renderInboxItem:l}):r()}));const va=f.selectRecentSearches,fa=(e,t)=>t.query?f.selectSearchConversations(e,t.query):[],Sa=(e,t)=>t.query?f.selectSearchFetchStatus(e,t.query):S.a.LOADED,Ia=(e,t)=>t.conversationIds||[],ka=(e,t)=>null!=e&&e.length?t.filter((t=>e.indexOf(t)>-1)):e;var Ca,xa=Object(d.a)().propsFromState((()=>({conversationIds:Ia,recentSearches:va,searchFetchStatus:Sa,searchConversationIds:fa}))).adjustStateProps((({conversationIds:e,recentSearches:t,searchConversationIds:a,searchFetchStatus:n})=>({conversationIds:e,recentSearches:t,searchFetchStatus:n,searchConversationIds:ka(a,e)}))).propsFromActions((()=>({addRecentSearch:f.addRecentSearches,createLocalApiErrorHandler:Object(I.createLocalApiErrorHandlerWithContextFactory)("DIRECT_MESSAGES_SEARCH"),search:f.searchConversations,clearRecentSearch:f.clearRecentSearch,clearRecentSearches:f.clearRecentSearches}))),wa=a("VY6S"),Fa=a("s14A"),Ma=a("VPW4"),Ta=a("mN6z");const La=void 0!==Ca?Ca:Ca=a("y59G"),Da="DM_MESSAGE_SEARCH",Ra={context:Da},Oa=e=>e,Pa=e=>{var t,a,n;const{footer:r,noItemsRenderer:l,onScrollEnd:i,renderInboxItem:o,searchTerm:c}=e,d=Object(Kt.c)(),{data:u,fetchNext:h,hasNext:p}=Object(jt.a)(La,{query:c}),m=null==u||null===(t=u.dm_message_slice_result)||void 0===t?void 0:t.items,g=null==u||null===(a=u.dm_message_slice_result)||void 0===a||null===(n=a.items)||void 0===n?void 0:n.map((e=>{var t,a;return null==e||null===(t=e.dm_event)||void 0===t||null===(a=t.legacy)||void 0===a?void 0:a.conversation})),b=Object(Tt.b)(g,[kt.a]),y=Object(Tt.b)(m,[kt.b]),_={...null==b?void 0:b.entities,...null==y?void 0:y.entities},E=(e=>{const t=s.a.useRef();return s.a.useEffect((()=>{t.current=e})),t.current})(u);return s.a.useEffect((()=>{Object(Ta.a)(u,E)||d(xt(_,!0))}),[_,u,E,d]),s.a.createElement(Mt.a,{cacheKey:Da,footer:p?null:r,identityFunction:Oa,items:null==y?void 0:y.result,noItemsRenderer:l,onNearEnd:h,onScrollEnd:i,renderer:o({conversationIds:null==b?void 0:b.result,isMessageItem:!0,messageIds:null==y?void 0:y.result}),withoutHeadroom:!0})},Ha=Ke.a.create((e=>({activityIndicatior:{paddingVertical:250}})));function Aa(e){return s.a.createElement(Nt.a,{errorConfig:Ra},s.a.createElement(s.a.Suspense,{fallback:s.a.createElement(Ma.a,{style:Ha.activityIndicatior})},s.a.createElement(Pa,e)))}var Na=a("j7Bv"),Ka=a("VwDm"),Ba=a("hOZg");const Ua=b.a.dbd5d40f;class ja extends s.a.PureComponent{render(){const{clearRecentSearch:e,handleRecentSearchClick:t,recentSearch:a}=this.props,n=s.a.createElement(Na.a,{Icon:Ka.a,color:"neutral",size:"xLarge",style:Va.searchIcon}),r=[Va.listItemView,Va.bottomBorder];return s.a.createElement(Ae.a,{onPress:t,style:r},s.a.createElement(ve.a,null,s.a.createElement(Ne.a,{avatarCell:n,avatarSize:"xLarge",cellStyle:Va.avatarColumn},s.a.createElement(ve.a,{style:Va.container},s.a.createElement(p.b,{numberOfLines:1},a),s.a.createElement(Oe.a,{accessibilityLabel:Ua,borderColor:"transparent",icon:s.a.createElement(Ba.a,null),onPress:e,type:"brandText"})))))}}const Va=Ke.a.create((e=>({container:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},searchIcon:{marginRight:e.spaces.space12,padding:e.spaces.space4},avatarColumn:{flexGrow:1,minWidth:"32px"},bottomBorder:{borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor},listItemView:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space12,width:"100%"}})));var za=ja;var qa=e=>Object(ba.a)({contextSuffix:"DM_GROUP_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMGroupSearch,sliceKey:`${je.e}-groups-${e}`,getEndpointParams:t=>({...t,query:e}),mapEntitiesToActions:xt});var Ga=e=>Object(ba.a)({contextSuffix:"DM_PEOPLE_SEARCH_SLICE",getFetchApiEndpoint:e=>e.DirectMessagesGraphQL.fetchDMPeopleSearch,sliceKey:`${je.e}-people-${e}`,getEndpointParams:t=>({...t,query:e}),mapEntitiesToActions:xt});const Wa=(e,t)=>t.query,Qa=(e,t)=>t.tabType;var $a=Object(d.a)().propsFromState((()=>({sliceModule:Object(M.createSelector)(Qa,Wa,((e,t)=>{const a=t&&e===je.f.PEOPLE;return t&&e===je.f.GROUPS?qa(t):a?Ga(t):void 0}))}))),Xa=a("FS1z");var Ya=$a((e=>{const{footer:t,onScrollEnd:a,renderEmptyState:n,renderInboxItem:r,sliceModule:l}=e;return l?s.a.createElement(Xa.a,{footer:t,module:l,noItemsRenderer:n,onScrollEnd:a,renderer:r({conversationIds:[]}),withoutHeadroom:!0}):n()})),Za=a("IG4P"),Ja=a("RJrc"),en=a("TnY3"),tn=a("FIs5"),an=a("6OUF"),nn=a("k/OQ"),rn=a("95Se");const ln=e=>e,sn=b.a.b08821f3,on=b.a.a66ac766,cn=b.a.fe61929d,dn=b.a.a846382a,un=b.a.b9dae4f4,hn=b.a.e7fb2027,pn=b.a.b92a21d8,mn=b.a.jdc67c42,gn=b.a.e8581ccd,bn=b.a.f08940ab,yn=b.a.gaae1fd5,_n=b.a.f8321d82,En=b.a.c94ac69d,vn=b.a.a2f8105f,fn=b.a.g2fd3205,Sn=b.a.fb3c8e74;class In extends s.a.Component{constructor(...e){super(...e),r()(this,"state",{debouncedQuery:"",isLoadingMore:!1,isRefreshing:!1}),r()(this,"_messageSearchEnabled",this.context.featureSwitches.isTrue("dm_inbox_search_message_results_enabled")),r()(this,"_modularSearchEnabled",this.context.featureSwitches.isTrue("dm_inbox_search_modular_results_enabled")),r()(this,"_setInputRef",(e=>{this._textInputRef=e})),r()(this,"_renderEmptyDMSearchInbox",(()=>{const{analytics:e,query:t}=this.props,{debouncedQuery:a}=this.state;return a&&t?(e.scribe({component:"search",element:"results",action:"empty"}),s.a.createElement(tn.a,{buttonLink:"/messages/compose",buttonText:bn,header:pn({query:a}),message:this._messageSearchEnabled?gn:mn,onButtonPress:this._handleComposeButtonPress})):s.a.createElement(ve.a,{style:kn.emptyState},s.a.createElement(p.b,{align:"center",color:"gray700"},yn))})),r()(this,"_renderRecentSearches",(()=>{const{analytics:e,query:t,recentSearches:a}=this.props;return a.length&&!t?s.a.createElement(s.a.Fragment,null,s.a.createElement(It,{analytics:e,clearRecentSearches:this._clearRecentSearches,headerText:Sn,withClearButton:!0}),a.map((e=>s.a.createElement(za,{clearRecentSearch:t=>this._handleClearRecentSearch(t,e),handleRecentSearchClick:()=>this._handleRecentSearchClick(e),key:e,recentSearch:e})))):this._renderEmptyDMSearchInbox()})),r()(this,"_renderAllDMSearchResultsTab",(()=>{const{location:e,renderInboxItem:t}=this.props,{debouncedQuery:a}=this.state;return a?s.a.createElement(Ea,{loadingLabel:on,location:e,query:a,renderEmptyState:this._renderEmptyDMSearchInbox,renderInboxItem:t}):this._renderEmptyDMSearchInbox()})),r()(this,"_renderConversationsTab",(e=>{const{renderInboxItem:t}=this.props,{debouncedQuery:a}=this.state;return s.a.createElement(Ya,{footer:this._renderFooter(),onScrollEnd:this._handleScrollEnd,query:a,renderEmptyState:this._renderEmptyDMSearchInbox,renderInboxItem:t,tabType:e?je.f.GROUPS:je.f.PEOPLE})})),r()(this,"_renderMessagesTab",(()=>{const{renderInboxItem:e}=this.props,{debouncedQuery:t}=this.state;return t?s.a.createElement(Aa,{footer:this._renderFooter(),noItemsRenderer:this._renderEmptyDMSearchInbox,onScrollEnd:this._handleScrollEnd,renderInboxItem:e,searchTerm:t}):this._renderEmptyDMSearchInbox()})),r()(this,"_renderTabContent",(()=>{const{location:e}=this.props,{tab:t}=(null==e?void 0:e.state)||{};switch(t){case fn:return this._renderConversationsTab(!1);case En:return this._renderConversationsTab(!0);case vn:return this._renderMessagesTab();default:return this._renderAllDMSearchResultsTab()}})),r()(this,"_renderSearchResults",(()=>{const{accessibilityTitle:e,renderInboxItem:t,searchConversationIds:a}=this.props,{isRefreshing:n}=this.state;return s.a.createElement(Fa.a,null,s.a.createElement(Za.a,{isRefreshing:n,onRefresh:this._handlePullToRefresh},s.a.createElement(Mt.a,{accessibilityRole:"tablist",accessibilityTitle:e,anchoring:Ft,assumedItemHeight:100,cacheKey:"dmSearchInbox",footer:this._renderFooter(),identityFunction:ln,items:a,noItemsRenderer:this._renderRecentSearches,onNearEnd:this._handleNearEnd,onScrollEnd:this._handleScrollEnd,renderer:t({conversationIds:a}),withoutHeadroom:!0})))})),r()(this,"_renderFooter",(()=>this.state.isLoadingMore?s.a.createElement(Ja.a,null):s.a.createElement(ve.a,{style:kn.footerContainer},s.a.createElement(p.b,{align:"center",size:"body",weight:"bold"},hn),s.a.createElement(He.a,{interactiveStyles:null},s.a.createElement(p.b,{align:"center",color:"primary",onPress:this._handleFooterClick,size:"subtext2",withInteractiveStyling:!0},un))))),r()(this,"_clearRecentSearches",(()=>{const{analytics:e,clearRecentSearches:t}=this.props;e.scribe({component:"recent_search",action:"clear"}),t()})),r()(this,"_handleComposeButtonPress",(()=>{const{analytics:e}=this.props;e.scribe({component:"search",element:"empty_results",action:"compose"})})),r()(this,"_handleFooterClick",(()=>{var e,t,a;this._textInputRef&&this._textInputRef.focus(),null===(e=this._textInputRef)||void 0===e||null===(t=e.textInput)||void 0===t||null===(a=t.textInputNode)||void 0===a||a.select()})),r()(this,"_handleRefetchSearch",(()=>{const{analytics:e,createLocalApiErrorHandler:t,search:a}=this.props,{debouncedQuery:n}=this.state;a&&n&&(e.scribe({component:"search",element:"retry",action:"click"}),a({query:n.toLowerCase(),preserveResults:!1,fetchNextPage:!1}).catch(t()))})),r()(this,"_handlePullToRefresh",(()=>{const{createLocalApiErrorHandler:e,search:t}=this.props,{debouncedQuery:a}=this.state;this.setState({isRefreshing:!0}),t&&a&&t({query:a.toLowerCase(),preserveResults:!0,fetchNextPage:!1}).then((()=>this.setState({isRefreshing:!1}))).catch((t=>(this.setState({isRefreshing:!1}),e()(t))))})),r()(this,"_handleSearchChangeInner",(e=>{const{createLocalApiErrorHandler:t,onQueryChange:a,search:n}=this.props;a(e),this.setState({debouncedQuery:e}),n&&e&&!this._modularSearchEnabled&&n({query:e,preserveResults:!1,fetchNextPage:!1}).catch(t())})),r()(this,"_handleSearchChangeDebounced",Object(wa.a)(this._handleSearchChangeInner,200)),r()(this,"_handleSearchChange",(({currentTarget:{value:e}})=>{const{onQueryChange:t}=this.props;(e&&e.trim()||!e)&&(t(e),this._handleSearchChangeDebounced(e))})),r()(this,"_handleNearEnd",(()=>{const{analytics:e,search:t}=this.props,{debouncedQuery:a}=this.state;this.setState({isLoadingMore:!0}),a&&(e.scribe({component:"search",element:"results",action:"get_older"}),t({query:a,preserveResults:!1,fetchNextPage:!0}).finally((()=>this.setState({isLoadingMore:!1}))))})),r()(this,"_handleScrollEnd",(()=>{const{addRecentSearch:e,analytics:t,query:a}=this.props,{debouncedQuery:n}=this.state;n&&a&&(e(a),t.scribe({component:"recent_search",action:"add"}))})),r()(this,"_handleSearchClear",(()=>this._handleSearchChangeInner(""))),r()(this,"_handleHideRecentSearches",(()=>{const{hideRecentSearches:e}=this.props;e()})),r()(this,"_handleAddRecentSearch",(({currentTarget:{value:e}})=>{const{addRecentSearch:t,analytics:a}=this.props;e&&(t(e),a.scribe({component:"recent_search",action:"add"}),this._textInputRef&&this._textInputRef.blur())})),r()(this,"_handleRecentSearchClick",(e=>{const{analytics:t,onQueryChange:a}=this.props;a(e),t.scribe({component:"recent_search",action:"click"}),this._handleSearchChangeInner(e)})),r()(this,"_handleClearRecentSearch",((e,t)=>{const{analytics:a,clearRecentSearch:n}=this.props;e.stopPropagation(),e.preventDefault(),a.scribe({component:"recent_search",action:"clear"}),n(t)}))}componentDidMount(){this._textInputRef&&this._textInputRef.focus()}componentDidUpdate(e){const{analytics:t,query:a,recentSearches:n}=this.props;e.query||!a||n.includes(a)||t.scribe({component:"search",action:"began_typing"})}render(){const{location:e,query:t,searchFetchStatus:a}=this.props,n=!(this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled")||this._modularSearchEnabled&&t),r=[kn.searchInput,n?kn.searchInputBorder:void 0],{tab:l}=(null==e?void 0:e.state)||{},i=[_n,fn,En];this._messageSearchEnabled&&i.push(vn);const o=i.map((t=>({key:t,label:t,isActive:()=>l===t||!l&&t===_n,to:{...e,state:{...e.state,tab:t}}})));return s.a.createElement(s.a.Fragment,null,s.a.createElement(ve.a,{style:r},s.a.createElement(Oe.a,{accessibilityLabel:sn,icon:s.a.createElement(rn.a,null),onPress:this._handleHideRecentSearches,pullLeft:!0,type:"primaryText"}),s.a.createElement(an.a,{Icon:Ka.a,autoComplete:"off",onChange:this._handleSearchChange,onClear:this._handleSearchClear,onSubmitEditing:this._handleAddRecentSearch,placeholder:this._messageSearchEnabled?dn:cn,ref:this._setInputRef,value:t,withClearButton:!0})),this._modularSearchEnabled&&(t||l===fn||l===En)?s.a.createElement(s.a.Fragment,null,s.a.createElement(nn.a,{links:o}),this._renderTabContent()):s.a.createElement(ra.a,{accessibilityLabel:on,fetchStatus:a,onRequestRetry:this._handleRefetchSearch,render:this._renderSearchResults}))}}r()(In,"contextType",o.a),r()(In,"defaultProps",{recentSearches:[],searchConversationIds:[],query:""});const kn=Ke.a.create((e=>({emptyState:{marginTop:e.spaces.space32},searchInput:{backgroundColor:e.colors.cellBackground,padding:e.spaces.space12,flexDirection:"row",alignItems:"center",zIndex:1},searchInputBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small},footerContainer:{marginVertical:e.spaces.space32}})));var Cn=Object(en.a)(xa(In)),xn=a("dwig"),wn=a("QB0K"),Fn=a("Avzu"),Mn=a("FRNI");const Tn=b.a.h845f281,Ln=b.a.f325afc3;class Dn extends s.a.PureComponent{render(){return s.a.createElement(wn.a,{accessibilityLabel:Tn,href:"/messages/compose",icon:s.a.createElement(Fn.a,null),label:Tn,scribeComponent:"floating_dm_button",shortLabel:Ln,testID:Mn.a.message})}}var Rn=Dn,On=a("tI3i"),Pn=a.n(On),Hn=a("883S"),An=a("yoO3"),Nn=a("GSsg"),Kn=a("2g+p"),Bn=a("mw9i"),Un=a("BcsE"),jn=a("+d3d");const Vn=e=>e,zn=b.a.a66ac766,qn=b.a.fe61929d,Gn=b.a.a846382a;class Wn extends s.a.Component{constructor(e,t){super(e,t),r()(this,"state",{showSearchView:!1,searchQuery:""}),r()(this,"_enablePinnedInbox",this.context.featureSwitches.isTrue("dm_conversation_labels_pinned_enabled")&&this.context.featureSwitches.isTrue("direct_messages_incremental_holdback_2022h1")),r()(this,"_messageSearchEnabled",this.context.featureSwitches.isTrue("dm_inbox_search_message_results_enabled")),r()(this,"_modularSearchEnabled",this.context.featureSwitches.isTrue("dm_inbox_search_modular_results_enabled")),r()(this,"_render",(()=>{const{withPinnedInbox:e}=this.props,{showSearchView:t}=this.state,a=this._enablePinnedInbox&&e?this._renderPinnedInbox:this._renderInbox;return t?this._renderFocusedSearch():a()})),r()(this,"_renderFocusedSearch",(()=>{const{accessibilityTitle:e,analytics:t,conversationIds:a}=this.props,{searchQuery:n}=this.state;return s.a.createElement(Cn,{accessibilityTitle:e,analytics:t,conversationIds:a,hideRecentSearches:this._hideRecentSearches,onQueryChange:this._handleQueryChange,query:n,renderInboxItem:this._renderInboxItem})})),r()(this,"_renderInbox",(()=>{const{accessibilityTitle:e,conversationIds:t,footer:a,isDrawer:n,isRefreshing:r,renderEmptyDMInbox:l,virtualScrollerCacheKey:i}=this.props;return s.a.createElement(Za.a,{isRefreshing:r,onRefresh:this._handlePullToRefresh},i&&t?s.a.createElement(Mt.a,{accessibilityRole:"tablist",accessibilityTitle:e,anchoring:Ft,assumedItemHeight:100,cacheKey:i,footer:a,header:this._renderHeader(),identityFunction:Vn,items:t,noItemsRenderer:l,onNearEnd:this._handleNearEnd,renderer:this._renderInboxItem({conversationIds:t}),withKeyboardShortcuts:!n,withoutHeadroom:!0}):null)})),r()(this,"_handleNearEnd",(()=>{this._handleHistoryRequest()})),r()(this,"_handleQueryChange",(e=>{this.setState({searchQuery:e})})),r()(this,"_handleSearchChange",(({currentTarget:{value:e}})=>{this.state.showSearchView||this.setState({showSearchView:!0})})),r()(this,"_handleSearchClick",(()=>{const{analytics:e}=this.props;e.scribe({component:"search",action:"click"}),this.setState({showSearchView:!0})})),r()(this,"_hideRecentSearches",(()=>{this.setState({showSearchView:!1,searchQuery:""})})),r()(this,"_renderInboxItem",(({conversationIds:e,isMessageItem:t=!1,messageIds:a,togglePinState:n})=>(r,l)=>{const{loggedInUserId:o}=this.context,{location:c}=this.props,{searchQuery:d}=this.state,u=t?(a||[]).indexOf(r):-1,h=-1!==u&&null!=e&&e.length?e[u]:null,p=h?r:"",m=h||r,g={pathname:`/messages/${m}`,state:null==c?void 0:c.state},b=m&&null!=e&&e.length?e.indexOf(m):null,y=Object(Un.a)(b)?b+1:0;return Pn()(!!o,"loggedInUserId must be defined"),l&&l(!0),s.a.createElement(i.a,{exact:!1,path:g.pathname},(e=>s.a.createElement(yt,{conversationId:m,inboxType:this.props.inboxType,isActive:e,isMessageItem:t,key:m,link:g,messageId:p,onClick:this._handleConversationClick,perspective:o,position:y,searchQuery:d,togglePinState:n})))})),r()(this,"_renderPinnedInbox",(()=>{const{accessibilityTitle:e,conversationIds:t,footer:a,isDrawer:n,renderEmptyDMInbox:r,virtualScrollerCacheKey:l}=this.props;return t.length?s.a.createElement(Jt,{accessibilityTitle:e,cacheKey:l,conversationIds:t,footer:a,header:this._renderHeader(),onNearEnd:this._handleNearEnd,renderEmptyDMInbox:r,renderInboxItem:this._renderInboxItem,withKeyboardShortcuts:!n}):r()})),r()(this,"_handleFetchInitialWrapper",(()=>{this._handleFetchInitial()})),r()(this,"_handleFetchInitial",(()=>{const{createLocalApiErrorHandler:e,fetchInboxIfNeeded:t,fetchUpdates:a}=this.props;return t().then(this._updateLastSeenEventId,e()).then((()=>{this._updatePolling.start()})).then((()=>a().catch(e())))})),r()(this,"_handleConversationClick",((e,t,a,n)=>{const{analytics:r,customCellClick:l}=this.props,s=null!=a&&a.participants?Object.keys(a.participants).length:0,i=(null==a?void 0:a.type)===f.CONVERSATION_TYPE.GROUP;r.scribe({element:"thread",action:"click",data:{event_value:this.state.searchQuery.length,conversation_id:t,conversation_participant_count:s,conversation_type:i?je.g.GROUP:je.g.ONE_TO_ONE,position:n}}),l&&l(e,t)})),r()(this,"_handleEmptyDMInboxImpression",(()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})})),r()(this,"_handlePullToRefresh",(()=>{const{createLocalApiErrorHandler:e,fetchInbox:t}=this.props;t().then(this._updateLastSeenEventId,e())})),r()(this,"_updateLastSeenEventIdIfActive",(()=>{if("background"!==Kn.a.currentState)return this._updateLastSeenEventId()})),r()(this,"_renderHeader",(()=>{const e=this.context.featureSwitches.isTrue("dm_vdl_enabled")&&this.context.featureSwitches.isTrue("dm_vdl_inbox_p0_enabled"),{renderStickyContent:t,withDmSearch:a}=this.props,n=[Qn.searchInput,e?void 0:Qn.searchInputBorder];return s.a.createElement(s.a.Fragment,null,a?s.a.createElement(ve.a,{onClick:this._handleSearchClick,style:n},s.a.createElement(an.a,{Icon:Ka.a,autoComplete:"off",isCompact:!0,onChange:this._handleSearchChange,placeholder:this._messageSearchEnabled?Gn:qn,withClearButton:!0})):null,t?t():null)})),r()(this,"_updateLastSeenEventId",(()=>{const{createLocalApiErrorHandler:e,updateLastSeenEventId:t}=this.props;return t().catch(e())})),this._fab=s.a.createElement(Rn,null)}componentDidMount(){const{createLocalApiErrorHandler:e,fetchInboxHistory:t,fetchUpdates:a}=this.props;return this._updatePolling=new Nn.a((()=>{a().then(this._updateLastSeenEventIdIfActive,e(Hn.a))}),{interval:8e3}),this._handleHistoryRequest=Object(jn.a)(((...a)=>{t(...a).catch(e())}),1e3),this._handleFetchInitial()}componentWillUnmount(){this._updatePolling.stop()}render(){return s.a.createElement(An.a,null,s.a.createElement(v,null),s.a.createElement(xn.a,{component:Bn.a,fab:this._fab,style:Qn.root},s.a.createElement(ra.a,{accessibilityLabel:zn,fetchStatus:this.props.fetchStatus,onRequestRetry:this._handleFetchInitialWrapper,render:this._render})))}}r()(Wn,"contextType",o.a),r()(Wn,"defaultProps",{conversationIds:[],inboxType:Ue.d.PRIMARY,isDrawer:!1,withDmSearch:!1,withPinnedInbox:!1});const Qn=Ke.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,flexGrow:1},searchInput:{backgroundColor:e.colors.cellBackground,padding:e.spaces.space12,zIndex:1},searchInputBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:"1px"}})));t.a=Object(en.a)(k(Wn))},rQjK:function(e,t,a){"use strict";a.r(t);const n={fragment:{argumentDefinitions:r=[{defaultValue:null,kind:"LocalArgument",name:"conversation_id"},{defaultValue:null,kind:"LocalArgument",name:"label_type"}],kind:"Fragment",metadata:null,name:"DMPinnedInboxDelete_Mutation",selections:l=[{alias:null,args:[{kind:"Variable",name:"conversation_id",variableName:"conversation_id"},{kind:"Variable",name:"label_type",variableName:"label_type"}],kind:"ScalarField",name:"dm_conversation_label_delete",storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:r,kind:"Operation",name:"DMPinnedInboxDelete_Mutation",selections:l},params:{id:"_TQxP2Rb0expwVP9ktGrTQ",metadata:{},name:"DMPinnedInboxDelete_Mutation",operationKind:"mutation",text:null}};var r,l;n.hash="f0ba5e0b671c54ae94c7322d3036a375",t.default=n},y59G:function(e,t,a){"use strict";a.r(t);const n={fragment:{argumentDefinitions:r=[{defaultValue:null,kind:"LocalArgument",name:"cursor"},{defaultValue:null,kind:"LocalArgument",name:"query"}],kind:"Fragment",metadata:null,name:"DMMessageSearchTabQuery",selections:[{alias:"dm_message_slice_result",args:[l={kind:"Variable",name:"query",variableName:"query"},s={kind:"Literal",name:"s",value:17}],concreteType:null,kind:"LinkedField",name:"__DMMessageSearchTabQuery_dm_message_slice_result_slice",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"items",plural:!0,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"DMEvent",kind:"LinkedField",name:"dm_event",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"rest_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"DMEventMetadata",kind:"LinkedField",name:"legacy",plural:!1,selections:[c={alias:null,args:null,kind:"ScalarField",name:"affects_sort",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"created_at_millis",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"request_id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"event_id",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"event_type",storageKey:null},{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[o,i,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[m={alias:null,args:null,kind:"ScalarField",name:"conversation_id",storageKey:null},{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[m,g={alias:null,args:null,kind:"ScalarField",name:"conversation_type",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"created_by_user_results",plural:!1,selections:E=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[o,i,_={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[b,y={alias:null,args:null,kind:"ScalarField",name:"screen_name",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"admin_user_results",plural:!1,selections:E,storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[o,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[v={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"original_img_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_img_height",storageKey:null}],type:"ApiImage",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[{kind:"InlineFragment",selections:[o,i,f={alias:null,args:null,concreteType:"ApiUser",kind:"LinkedField",name:"legacy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id_str",storageKey:null},b,y,{alias:null,args:null,kind:"ScalarField",name:"profile_image_url_https",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"last_read_event_id",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"join_time_millis",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"join_conversation_event_id",storageKey:null}],storageKey:null},C={alias:null,args:null,concreteType:"PerspectivalConversationMetadata",kind:"LinkedField",name:"perspectival_conversation_metadata",plural:!1,selections:[S,{alias:null,args:null,kind:"ScalarField",name:"low_quality",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"muted_due_to_muted_user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"read_only",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trusted",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DMEventDetail",kind:"LinkedField",name:"event_detail",plural:!1,selections:[x={alias:null,args:null,concreteType:"DMInitialLowQualityState",kind:"LinkedField",name:"initial_low_quality_state",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_low_quality",storageKey:null}],storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"is_new_one_to_one_convo",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"is_spam_hide",storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"marked_as_abuse",storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"message_id",storageKey:null},b,L={alias:null,args:null,kind:"ScalarField",name:"possibly_spam",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"sender_registration_token",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"users_results",plural:!0,selections:E,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"participants_snapshot_results",plural:!0,selections:E,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"initiating_user_results",plural:!1,selections:E,storageKey:null},{alias:null,args:null,concreteType:"DirectMessageInfo",kind:"LinkedField",name:"dm",plural:!1,selections:[R={alias:null,args:null,kind:"ScalarField",name:"created_at_sec",storageKey:null},o,O={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"recipient_results",plural:!1,selections:E,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"sender_results",plural:!1,selections:E,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"DMMessageSearchItem",abstractKey:null}],storageKey:null},P={alias:null,args:null,concreteType:"SliceInfo",kind:"LinkedField",name:"slice_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"next_cursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"previous_cursor",storageKey:null}],storageKey:null}],type:"DMMessageSlice",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:r,kind:"Operation",name:"DMMessageSearchTabQuery",selections:[{alias:null,args:H=[{kind:"Variable",name:"cursor",variableName:"cursor"},l,s],concreteType:null,kind:"LinkedField",name:"dm_message_slice_result",plural:!1,selections:[A={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"items",plural:!0,selections:[A,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"DMEvent",kind:"LinkedField",name:"dm_event",plural:!1,selections:[i,o,{alias:null,args:null,concreteType:"DMEventMetadata",kind:"LinkedField",name:"legacy",plural:!1,selections:[c,d,u,h,p,{alias:null,args:null,concreteType:"DMConversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[o,i,{alias:null,args:null,concreteType:"ConversationInfo",kind:"LinkedField",name:"legacy",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ConversationMetadata",kind:"LinkedField",name:"metadata",plural:!1,selections:[m,g,b,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"created_by_user_results",plural:!1,selections:K=[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[A,{kind:"InlineFragment",selections:[o,i,_,N={alias:null,args:null,filters:null,handle:"defaultScalars",key:"",kind:"LinkedHandle",name:"legacy"}],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"admin_user_results",plural:!1,selections:K,storageKey:null},{alias:null,args:null,concreteType:"ApiMedia",kind:"LinkedField",name:"avatar",plural:!1,selections:[o,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media_info",plural:!1,selections:[A,v],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ParticipantConversationMetadata",kind:"LinkedField",name:"participants_metadata",plural:!0,selections:[{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"user_results",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[A,{kind:"InlineFragment",selections:[o,i,f,N],type:"User",abstractKey:null}],storageKey:null}],storageKey:null},S,I,k],storageKey:null},C],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DMEventDetail",kind:"LinkedField",name:"event_detail",plural:!1,selections:[x,w,F,M,T,b,L,D,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"users_results",plural:!0,selections:K,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"participants_snapshot_results",plural:!0,selections:K,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"initiating_user_results",plural:!1,selections:K,storageKey:null},{alias:null,args:null,concreteType:"DirectMessageInfo",kind:"LinkedField",name:"dm",plural:!1,selections:[R,o,O,{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"recipient_results",plural:!1,selections:K,storageKey:null},{alias:null,args:null,concreteType:"UserResults",kind:"LinkedField",name:"sender_results",plural:!1,selections:K,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"DMMessageSearchItem",abstractKey:null}],storageKey:null},P],type:"DMMessageSlice",abstractKey:null}],storageKey:null},{alias:null,args:H,filters:["query","s"],handle:"slice",key:"DMMessageSearchTabQuery_dm_message_slice_result",kind:"LinkedHandle",name:"dm_message_slice_result"}]},params:{id:"bbdRrkndYmyQHx463K9HSA",metadata:{sliceInfoPath:["dm_message_slice_result","slice_info"]},name:"DMMessageSearchTabQuery",operationKind:"query",text:null}};var r,l,s,i,o,c,d,u,h,p,m,g,b,y,_,E,v,f,S,I,k,C,x,w,F,M,T,L,D,R,O,P,H,A,N,K;n.hash="f240afda618da0d5e047ef48ee76dd56",t.default=n}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.DMDrawer.9710bb55.js.map