(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{"+0pD":function(t,e){var i="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function s(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function o(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=i?s:o).supported=s,e.unsupported=o},"06eB":function(t,e,i){var s=Array.prototype.slice,o=i("kgfz"),n=i("+0pD"),r=t.exports=function(t,e,i){return i||(i={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?i.strict?t===e:t==e:function(t,e,i){var c,d;if(h(t)||h(e))return!1;if(t.prototype!==e.prototype)return!1;if(n(t))return!!n(e)&&(t=s.call(t),e=s.call(e),r(t,e,i));if(a(t)){if(!a(e))return!1;if(t.length!==e.length)return!1;for(c=0;c<t.length;c++)if(t[c]!==e[c])return!1;return!0}try{var l=o(t),u=o(e)}catch(t){return!1}if(l.length!=u.length)return!1;for(l.sort(),u.sort(),c=l.length-1;c>=0;c--)if(l[c]!=u[c])return!1;for(c=l.length-1;c>=0;c--)if(d=l[c],!r(t[d],e[d],i))return!1;return typeof t==typeof e}(t,e,i))};function h(t){return null==t}function a(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}},"3AAD":function(t,e,i){"use strict";const s={...i("7n04").a,pinToNewestWhenAtNewest:!0};e.a=s},"64vW":function(t,e,i){"use strict";var s=i("ERkP");const o=i.n(s).a.createContext({heightsReady:!0});e.a=o},FwSR:function(t,e,i){"use strict";i.r(e),i.d(e,"resetIsModalScrollerRendered",(function(){return lt})),i.d(e,"default",(function(){return ut}));var s=i("KEM+"),o=i.n(s),n=i("ERkP"),r=i.n(n);class h{constructor(t,e,i,s,o){this.id=t,this._renderer=i,this.canBeAnchor=s,this.data=e,this.sortIndex=o}render(t){const{_renderer:e,data:i}=this;return e(i,t)}}const a=(t,e,i,s,o="-1")=>new h(t,e,i,s,o),c=Object.freeze({FocusedItem:"focusedItem",Anchor:"anchor"});var d=t=>({anchor:t,type:c.Anchor}),l=t=>({itemId:t,type:c.FocusedItem}),u=i("OrGc"),m=i("hACr"),_=i("7N4s"),p=i("3AAD"),g=i("oi7R"),f=i("JD1h"),I=i("aWzz"),w=i("oQhu"),v=i("+d3d"),b=i("fs1G"),R=i("zrc3"),y=i("7nmT"),A=i.n(y);const T=t=>{var e;return null===(e=t.find((t=>t.focusable)))||void 0===e?void 0:e.id};var H=i("dPJJ"),S=i("E6XO"),E=i("jHwr");class F{constructor({listLength:t,listRect:e,renderedItems:i,viewportRect:s}){this._viewportRect=s,this._listRect=e,this._listLength=t,this._renderedItems=i}getForList(){return this._listRect}getForViewport(){return this._viewportRect}getListLength(){return this._listLength}getRenderedItems(){return this._renderedItems}}var O=i("64vW"),P=i("Resy");class x{constructor(t,e,i,s,o=0){this.itemId=t,this.offset=e,this.visible=i,this.canBeAnchor=s,this.height=o}getRectInViewport(){return new P.a(this.offset,this.height)}}var N=i("z0MJ"),C=i.n(N),B=i("pQ3Z"),M=i.n(B),V=i("iBK2"),j=i("gbD7"),U=i("aITJ"),L=i("Irs7"),D=i("v6aA"),z=i("38/B"),W=i("06eB"),k=i.n(W),K=i("mN6z");var J=r.a.createContext({onAnimationStarted:()=>{},onAnimationEnded:()=>{},onHeightChanged:()=>{}});const q=()=>window.performance?window.performance.now():Date.now(),Y="transform 0.15s linear";class $ extends r.a.Component{constructor(t,e){super(t,e),o()(this,"_contentsFocusable",!1),o()(this,"_perfReported",!1),o()(this,"_shouldAnimateTranslate",!1),o()(this,"_observeElement",(t=>{const e=this._resizeObserver;e&&(e.disconnect(),e.observe(t))})),o()(this,"_handleResize",(t=>{const{item:e,onHeightChanged:i}=this.props,[s]=t,o=(s&&Math.floor(s.contentRect.height))!==(this._currentHeight&&Math.floor(this._currentHeight));s&&o&&(this._currentHeight=s.contentRect.height,i(e.id,s.contentRect.height)),this._recordTTFV()})),o()(this,"_setRef",(t=>{const{item:e,setAPI:i}=this.props;t?(this._element=t,i(e.id,this),this._observeElement(t)):(i(e.id,void 0),this._element=void 0)})),o()(this,"_setIsItemFocusable",(t=>{this._contentsFocusable=t})),o()(this,"_handleAnimationStarted",((t=Y)=>{this._resizeObserver&&this._resizeObserver.disconnect(),this.props.onAnimationStarted(this.props.item.id,t),this._animationTTLTimeoutId&&clearTimeout(this._animationTTLTimeoutId),this._animationTTLTimeoutId=setTimeout(this._handleAnimationEnded,1e3)})),o()(this,"_handleAnimationEnded",(()=>{this._animationTTLTimeoutId&&(clearTimeout(this._animationTTLTimeoutId),this._animationTTLTimeoutId=null),this._element&&this._observeElement(this._element),this.props.onAnimationEnded(this.props.item.id)})),o()(this,"_handleHeightChanged",(t=>{this._currentHeight=t,this.props.onHeightChanged(this.props.item.id,t)}));const i=U.b.isSafari()?window.PolyfillResizeObserver:window.ResizeObserver;this._resizeObserver=new i(this._handleResize),this._animationContext={onAnimationEnded:this._handleAnimationEnded,onAnimationStarted:this._handleAnimationStarted,onHeightChanged:this._handleHeightChanged},this._perfStart=q()}shouldComponentUpdate(t){const{item:e,positioningStyle:i,shouldAnimate:s,visible:o}=this.props,n=!Object(K.a)(t.positioningStyle,i);return this._shouldAnimateTranslate=n&&t.visible===o,!k()(t.item,e)||n||t.visible!==o||t.shouldAnimate!==s}componentWillUnmount(){this._animationTTLTimeoutId&&(clearTimeout(this._animationTTLTimeoutId),this.props.onAnimationEnded(this.props.item.id)),this._resizeObserver&&this._resizeObserver.disconnect(),this._resizeObserver=void 0}componentDidUpdate(t){const{item:e,setAPI:i}=this.props;t.item.id!==e.id&&(i(t.item.id,void 0),i(e.id,this)),this._recordTTFV()}getElement(){return this._element}isFocusable(){return this._contentsFocusable}measureHeight(){return this._currentHeight||(this._currentHeight=this._element?this._element.getBoundingClientRect().height:0),this._currentHeight}render(){const{item:t,shouldAnimate:e,translationTransitionStyle:i,visible:s}=this.props,o=this._shouldAnimateTranslate&&!z.a.reducedMotionEnabled?i:"opacity 0.3s ease-out",n={...this.props.positioningStyle,position:"absolute",opacity:s?void 0:.01,width:"100%",transition:e&&!this._isAnimationDisabled?o:void 0};return r.a.createElement(J.Provider,{value:this._animationContext},r.a.createElement("div",{ref:this._setRef,style:n},t.render(this._setIsItemFocusable)))}_recordTTFV(){const{item:t,onVisible:e,visible:i}=this.props;void 0!==this._currentHeight&&!this._perfReported&&i&&(e(t.id,q()-this._perfStart),this._perfReported=!0)}}o()($,"contextType",D.a),o()($,"defaultProps",{translationTransitionStyle:Y});var G=i("VY6S"),Q=i("Qyxo"),X=i("qdp+"),Z=i("/NU0"),tt=i("6vUc"),et=i("jat/"),it=i("xN10"),st=i("Myq3");const ot={},nt=({cssPixels:t,dpr:e})=>Math.ceil(t*e)/e;class rt extends r.a.Component{constructor(t,e){super(t,e),o()(this,"_areAnchorsInvalidated",!1),o()(this,"_cells",new Map),o()(this,"_cellAnimations",new Set),o()(this,"_cellAnimationStyle",Y),o()(this,"_currentHeadroom",0),o()(this,"_isFullScreened",!1),o()(this,"_isIdle",!0),o()(this,"_pendingHeightUpdates",new Map),o()(this,"_previousScrollPosition",0),o()(this,"_renderedItemsStatus",new Set),o()(this,"_rootRef",r.a.createRef()),o()(this,"_slice",{start:0,end:0}),o()(this,"_shouldScribeNextScroll",!0),o()(this,"_visibilityMeasurements",new Map),o()(this,"_handleScroll",(()=>{this._wasPreviouslyAtNewestEnd=this.isAtNewest(),this._isInitialAnchoring||this._viewport.scrollY()<0||(this._isIdle=!1,this._updateScrollEnd(),this._scheduleCriticalUpdateThrottled())})),o()(this,"_updateScrollEnd",Object(G.a)((()=>{const{analytics:t,onScrollEnd:e}=this.props,i=this._viewport.scrollY()-this._previousScrollPosition;this._previousScrollPosition=this._viewport.scrollY(),this._shouldScribeNextScroll&&Math.abs(i)>100&&t.scribe({action:"scroll",data:{event_value:i}}),this._shouldScribeNextScroll=!0,this._isIdle=!0,e(),this._scheduleCriticalUpdate()}),200)),o()(this,"_handleProgrammaticScroll",(()=>{this._shouldScribeNextScroll=!1})),o()(this,"_handleEnterFullscreen",(()=>{this._isFullScreened=!0})),o()(this,"_handleExitFullscreen",(()=>{this._isFullScreened=!1,this._scheduleCriticalUpdate()})),o()(this,"_getPositioningContext",Object(w.a)((t=>({heightsReady:t})))),o()(this,"_getFinalRenderedItemsMemoized",Object(w.a)(((t,e)=>{const i=this._getItemMapMemoized(t);return Object(Q.a)(e,(t=>{const e=i.get(t.itemId);return e&&{item:e,offset:t.offset,visible:t.visible}}))}))),o()(this,"_getItemMapMemoized",Object(w.a)((t=>{const e=new Map;return t.forEach((t=>{e.set(t.id,t)})),e}))),o()(this,"_getInitialRenderedItems",(()=>{const{initialAnchor:t,list:e}=this.props,i=[];if(!t)return i;if(t.type===c.FocusedItem){const s=Object(X.a)(e,(e=>e.id===t.itemId?new x(e.id,0,!0,e.canBeAnchor):void 0));s&&i.push(s)}else if(t.type===c.Anchor&&Object(Z.a)(t.anchor.distanceToViewportTop)){const{anchor:s}=t,o=this._getDocumentViewportHeight(),n=s.distanceToViewportTop||0,r=e.findIndex((t=>t.id===s.id));let h=n,a=r;for(;a>-1&&a<e.length&&h<o;){const t=e[a],s=this._heights.get(t.id);if(!Object(Z.a)(s))break;i.push(new x(t.id,h,!0,t.canBeAnchor)),h+=s,a+=1}for(h=n,a=r-1;a>-1&&h>0;){const t=e[a],s=this._heights.get(t.id);if(!Object(Z.a)(s))break;h-=s,i.unshift(new x(t.id,h,!0,t.canBeAnchor)),a-=1}}return i})),o()(this,"_getViewportOffsetCorrection",(()=>{const t=this._rootRef.current&&this._rootRef.current.getBoundingClientRect();if(!t||!this._viewport)return 0;const e=this._viewport instanceof g.a?0:this._viewport.getRect().getTop();return nt({cssPixels:t.top-e,dpr:this._devicePixelRatio})})),o()(this,"getAnchors",(()=>{const t=this._rootRef.current&&this._rootRef.current.getBoundingClientRect(),e=this._measureRelativeViewportRect();return t&&e?this._getItemsWithin(e).filter((t=>t.item.canBeAnchor)).map((t=>({id:t.item.id,distanceToViewportTop:nt({cssPixels:t.offset+this._getViewportOffsetCorrection(),dpr:this._devicePixelRatio}),wasFocused:this._hasUserChangedFocus&&t.item.id===this._activeEntryId}))):[]})),o()(this,"_update",(()=>{const t=this._measureRelativeViewportRect();if(!t)return;if(this._isFullScreened)return;const e=this._getAnchor(t);this._measureHeights(),e&&(this._updateRenderedItems(e,t),this._areAnchorsInvalidated=!1)})),o()(this,"_getItemsWithPositions",(t=>{const{list:e}=this.props,i=this._getDistanceFromTop(t.itemId);let s=t.offset-i;const o=[];return e.forEach((t=>{const e=this._getHeight(t);o.push(new x(t.id,s,this._heights.has(t.id),t.canBeAnchor,e)),s+=e})),o})),o()(this,"_getSliceForCandidates",((t,e)=>{const i=Object(tt.a)(t),s=Object(et.a)(t);return{start:i?e.indexOf(i):0,end:s?e.indexOf(s)+1:0}})),o()(this,"_getRenderCandidates",((t,e)=>{const{minimumOffscreenToViewportRatio:i,preferredOffscreenToViewportRatio:s}=this.props,o=ct(e,i),n=ct(e,s),r=this._isIdle&&!this._isInitialAnchoring,h=this._getItemsWithPositions(t),a=h.filter((t=>this._getRenderedItemRectInViewport(t).doesIntersectWith(r?n:o))),c=this._getSliceForCandidates(a,h),d=((t,e,i)=>{if(i)return e;if(e.start>=t.start&&e.end<=t.end&&t.end-t.start<=50)return t;if(e.start>=t.end||e.end<=t.start)return e;{const i=Math.max(t.start-e.start,e.end-t.end,0);return{start:Math.min(t.start+i,e.start),end:Math.max(t.end-i,e.end)}}})(this._slice,c,r),l=h.slice(d.start,d.end);return{allItemsWithPositions:h,newRenderedItems:l,slice:d,arePreferredItemsRendered:r}})),o()(this,"_getIsHeightsReady",(t=>Object(it.a)(t,(({itemId:t})=>this._heights.has(t))))),o()(this,"_getHeightBetweenItems",((t,e)=>t&&e?this._getRenderedItemRectInViewport(e).getBottom()-this._getRenderedItemRectInViewport(t).getTop():0)),o()(this,"_getRenderedItemRectInViewport",(t=>t.getRectInViewport())),o()(this,"_updateRenderedItems",((t,e)=>{const{allItemsWithPositions:i,arePreferredItemsRendered:s,newRenderedItems:o,slice:n}=this._getRenderCandidates(t,e),r=0!==this._cellAnimations.size,h=this._shouldNormalize(t),a=Object(tt.a)(i),c=Object(et.a)(i),d=this._getHeightBetweenItems(a,c),l=d+this._calculateHeadroom(i,e),u=this._getIsHeightsReady(o),m=!(U.b.isSafari()||U.b.isIOS()),_=!r&&u&&(this._isIdle||m||l<=e.getHeight())||u&&this._isInitialAnchoring;let p=o;if(this._slice=n,u&&(this._isInitialAnchoring=!1),h&&_){const{offset:i,renderedItems:s}=this._normalization(t,o);p=s,this.setState({renderedItems:s,listHeightWithHeadroom:l,shouldAnimate:!h},(()=>{let t=e;0!==i&&(this._viewport.scrollBy(-i),t=this._measureRelativeViewportRect()),t&&this._updatePositioning({renderedItems:p,relativeViewportRect:t,firstItem:a,newListHeight:d})}))}else this.setState({renderedItems:o,listHeightWithHeadroom:l,shouldAnimate:!0},(()=>{!h&&s||this._scheduleUpdateDebounced(),this._updatePositioning({renderedItems:p,relativeViewportRect:e,firstItem:a,newListHeight:d})}))})),o()(this,"_updatePositioning",(({firstItem:t,newListHeight:e,relativeViewportRect:i,renderedItems:s})=>{const{list:o,onPositionUpdate:n}=this.props;if(this._getIsHeightsReady(s)){const r=t?this._getRenderedItemRectInViewport(t).getTop():0;n(new F({viewportRect:i,listRect:new P.a(r,e),listLength:o.length,renderedItems:s.map((t=>({id:t.itemId,rectangle:new P.a(t.offset,this._getHeightForItemId(t.itemId))})))}))}})),o()(this,"_shouldNormalize",(t=>this.props.hasNewContentAtBottom?this._getListOffset(t)-this._currentHeadroom!=0:0!==this._getListOffset(t))),o()(this,"_normalization",((t,e)=>{const i=this._getListOffset(t);return{offset:i,renderedItems:e.map((t=>new x(t.itemId,t.offset-i,t.visible,t.canBeAnchor)))}})),o()(this,"_calculateHeadroom",((t,e)=>this.props.withoutHeadroom?(this._currentHeadroom=0,this._currentHeadroom):this.props.hasNewContentAtBottom?this._calculateTopHeadroom(t,e):this._calculateBottomHeadroom(t,e))),o()(this,"_calculateBottomHeadroom",((t,e)=>{const i=Object(st.a)(t,(t=>t.canBeAnchor)),s=Object(et.a)(t);if(!s)return this._currentHeadroom=0,this._currentHeadroom;const o=this._getRenderedItemRectInViewport(s),n=o.getBottom()-(i?this._getRenderedItemRectInViewport(i).getTop():o.getTop());return this._currentHeadroom=Math.max(0,e.getHeight()-n+this._viewport.getOffsetBottom()),this._currentHeadroom})),o()(this,"_calculateTopHeadroom",((t,e)=>{const i=Object(st.a)(t,(t=>t.canBeAnchor)),s=Object(tt.a)(t);if(!s)return this._currentHeadroom=0,this._currentHeadroom;const o=this._getRenderedItemRectInViewport(s),n=(i?this._getRenderedItemRectInViewport(i).getBottom():o.getBottom())-o.getTop(),r=this._getDocumentViewportHeight()-e.getHeight();return this._currentHeadroom=Math.max(0,e.getHeight()-n-r),this._currentHeadroom})),o()(this,"_getListOffset",(t=>{if(!t)return this.props.hasNewContentAtBottom?this._currentHeadroom:0;const e=this._getDistanceFromTop(t.itemId);return this.props.hasNewContentAtBottom?t.offset-e-this._currentHeadroom:t.offset-e})),o()(this,"_getAnchorItemCandidates",(()=>{const{analytics:t}=this.props,e=this._getFinalRenderedItems(),i=e.filter((({item:t})=>t.canBeAnchor&&(this._isInitialAnchoring||!!this._heights.get(t.id))));if(this._areAnchorsInvalidated){const i=e.filter((({item:t})=>{var e;const i=null===(e=this._previousItemMap.get(t.id))||void 0===e?void 0:e.sortIndex;return i===V.a||t.sortIndex===V.a||i===t.sortIndex}));if(i.length!==e.length){if(t.scribe({element:"scroller",action:"hoisted_anchor_invalidation"}),this.context.featureSwitches.isTrue("responsive_web_hoisting_anchor_invalidation_enabled"))return i}else t.scribe({element:"scroller",action:"no_hoisted_anchor_invalidation"})}return i})),o()(this,"_shouldPinToNewest",(()=>!this._isInitialAnchoring&&!!this.props.pinToNewestWhenAtNewest&&this.isAtNewest())),o()(this,"_getAnchor",(t=>{if(this._shouldPinToNewest()){if(this.props.hasNewContentAtBottom){const t=Object(et.a)(this.state.renderedItems);return t?{itemId:t.itemId,offset:t.offset}:void 0}{const t=Object(tt.a)(this.props.list);return t?{itemId:t.id,offset:0}:void 0}}const e=e=>{const i=(s=e,o=t,Math.max(0,Math.min(s.getBottom(),o.getBottom())-Math.max(s.getTop(),o.getTop())));var s,o;return(e.getHeight()>0?i/e.getHeight():0)>.01?1:0},i=e=>e.getBottom()-t.getTop(),s=this._getAnchorItemCandidates(),o=at(s,((t,s)=>{const o=new x(t.item.id,t.offset,t.visible,!0,this._getHeight(t.item)).getRectInViewport(),n=new x(s.item.id,s.offset,s.visible,!0,this._getHeight(s.item)).getRectInViewport();return this.props.hasNewContentAtBottom?e(o)-e(n)||Math.abs(i(o))-Math.abs(i(n)):e(o)-e(n)||Math.abs(i(n))-Math.abs(i(o))}));if(o)return{itemId:o.item.id,offset:o.offset};const n=Object(tt.a)(s);if(n)return{itemId:n.item.id,offset:n.offset};{const t=Object(tt.a)(this.props.list);return t?{itemId:t.id,offset:0}:void 0}})),o()(this,"_measureRelativeViewportRect",(()=>{const t=this._rootRef.current;if(t)return this._viewport.getRect().translateBy(-t.getBoundingClientRect().top)})),o()(this,"_getHeight",(t=>{var e;return this._getHeightForItemId(t.id,null===(e=t.data)||void 0===e?void 0:e.type)})),o()(this,"_getHeightForItemId",((t,e="")=>{const{assumedItemHeight:i}=this.props,s=this._heights.get(t),o=Object(Z.a)(s)?s:"function"==typeof i?i(e):i;return nt({cssPixels:o,dpr:this._devicePixelRatio})})),o()(this,"_getDistanceFromTop",(t=>{const{list:e}=this.props,i=e.findIndex((e=>e.id===t));return i>=0?e.slice(0,i).reduce(((t,e)=>this._getHeight(e)+t),0):0})),o()(this,"_getItemsWithin",(t=>this._getFinalRenderedItems().filter((({item:e,offset:i})=>new P.a(i,this._getHeight(e)).doesIntersectWith(t))))),o()(this,"_measureHeights",(()=>{this._cells.forEach(((t,e)=>{this._heights.set(e,t.measureHeight())}))})),o()(this,"_handleAnimationStarted",((t,e)=>{this._cellAnimations.add(t),e&&(this._cellAnimationStyle=e)})),o()(this,"_handleAnimationEnded",(t=>{this._cellAnimations.delete(t),this._cellAnimationStyle=Y})),o()(this,"_handleItemVisible",((t,e)=>{this._visibilityMeasurements.has(t)||this._visibilityMeasurements.set(t,e)})),o()(this,"_reportVisibilityMeasurements",(()=>{if(!this._visibilityMeasurements.size)return;let t=0;this._visibilityMeasurements.forEach((e=>t+=e));const e=Math.round(t/this._visibilityMeasurements.size),i=U.b.isDesktopOS()?"scroller_v3":"scroller_v3_mobile";S.c(`scroller:ttfv:${i}`,{duration_ms:e}),this._visibilityMeasurements.clear()})),o()(this,"_updateItemHeight",((t,e)=>{this._pendingHeightUpdates.set(t,e);(Object(it.a)(this.state.renderedItems,(({itemId:t})=>this._heights.has(t)||this._pendingHeightUpdates.has(t)))||this._pendingHeightUpdates.size>50)&&(this._update(),this._pendingHeightUpdates.clear())})),o()(this,"_handleHeightChanged",((t,e,i=!1)=>{this._heights.get(t)!==e&&(this._cellAnimations.has(t)?this._scheduleCriticalUpdate():this._updateItemHeight(t,e))})),o()(this,"_setItemRef",((t,e)=>{e?(this._cells.set(t,e),this._renderedItemsStatus.add(t)):(this._cells.delete(t),this._renderedItemsStatus.delete(t))})),o()(this,"_getRenderedItemsWithFocusability",(()=>this._getFinalRenderedItems().map((({item:t,visible:e})=>{const i=this._cells.get(t.id);return{id:t.id,focusable:!(!i||!i.isFocusable()),visible:e}})))),o()(this,"_findNewestVisibleId",(()=>{const t=this._measureRelativeViewportRect(),e=t&&this._getFinalRenderedItems().find((({item:e,offset:i})=>new P.a(i,this._getHeight(e)).doesIntersectWith(t)));return e&&e.item.id})),o()(this,"adjustFocusBy",(t=>{this._hasUserChangedFocus=!0;const e=this._getRenderedItemsWithFocusability();let i=this._activeEntryId&&((t,e,i)=>{const s=t?Object(R.a)(i,(e=>e.id===t)):-1;if(s>=0)for(let t=s>=0?s+e:0;t>=0&&t<i.length;t+=e)if(i[t].focusable)return i[t].id;return s>=0?t:void 0})(this._activeEntryId,t,e);if(!i){const t=this._findNewestVisibleId();i=t?((t,e)=>{const i=Object(R.a)(e,(e=>e.id===t));let s;if(i>=0){const t=e.find(((t,e)=>e>=i&&t.focusable));s=t?t.id:void 0}return s||T(e)})(t,e):T(e)}i&&this._updateFocusToItem(i)})),o()(this,"_updateFocusToItem",((t,e)=>{if(t!==this._activeEntryId){const i=this._getRenderedItemsWithFocusability().find((e=>e.visible&&e.id===t)),s=this._cells.get(t),o=s&&s.getElement();i&&(this._activeEntryId=t,o&&((t,e,i)=>{const s=A.a.findDOMNode(t),o=s&&s instanceof window.HTMLElement&&s.querySelector("a, [tabindex='0']");if(o){o.scrollIntoView(i),o.focus();const t=(e||g.a.root()).getRect().getTop();t>0&&window.scrollBy(0,-1*t)}})(o,this.context.viewport,e))}})),o()(this,"scrollToNewest",(t=>{this._hasUserChangedFocus=!0,this.props.hasNewContentAtBottom?this._viewport.scrollTo(0,this.state.listHeightWithHeadroom):this._viewport.scrollToTop(),t&&(this._update(),C()((()=>{const t=this._getRenderedItemsWithFocusability(),e=T(t);e&&this._updateFocusToItem(e,{block:"nearest"})})))})),o()(this,"isAtNewest",(()=>{const t=this._measureRelativeViewportRect();return!t||(this.props.hasNewContentAtBottom?t.getBottom()>=this.state.listHeightWithHeadroom-50:t.getTop()<=50)})),this._viewport=t.viewport,this._devicePixelRatio=window.devicePixelRatio||1,this.state={renderedItems:[],listHeightWithHeadroom:0,shouldAnimate:!1};const{cacheKey:i,initialAnchor:s}=this.props;i&&ot.hasOwnProperty(i)?this._heights=ot[i]:(this._heights=new Map,ot[i]=this._heights),this._scheduleCriticalUpdate=Object(E.a)((()=>this._update()),window.requestAnimationFrame),this._scheduleUpdate=window.requestIdleCallback?Object(E.a)((()=>{this._update()}),window.requestIdleCallback):this._scheduleCriticalUpdate,this._scheduleCriticalUpdateThrottled=Object(v.a)((()=>{this._scheduleCriticalUpdate()}),100,{trailing:!0}),this._scheduleUpdateDebounced=Object(G.a)(this._scheduleUpdate,250),this._wasPreviouslyAtNewestEnd=!s,this._removeViewportResizeHandler=this._viewport.addRectChangeListener(this._scheduleCriticalUpdateThrottled),this._shouldUseTopPositioning=this.context.featureSwitches.isTrue("responsive_web_scroller_top_positioning_enabled")||U.b.isMobileOS()&&U.b.isSafari(),window.scroller=this}render(){const{listHeightWithHeadroom:t,renderedItems:e,shouldAnimate:i}=this.state,s=this._getIsHeightsReady(e);return r.a.createElement(O.a.Provider,{value:this._getPositioningContext(s)},r.a.createElement("div",{ref:this._rootRef,style:{position:"relative",minHeight:t}},this._getFinalRenderedItems().map((({item:t,offset:e,visible:s})=>{const o={top:this._shouldUseTopPositioning?`${e}px`:void 0,transform:this._shouldUseTopPositioning?void 0:`translateY(${e}px)`};return r.a.createElement($,{item:t,key:t.id,onAnimationEnded:this._handleAnimationEnded,onAnimationStarted:this._handleAnimationStarted,onHeightChanged:this._handleHeightChanged,onVisible:this._handleItemVisible,positioningStyle:o,setAPI:this._setItemRef,shouldAnimate:i,translationTransitionStyle:this._cellAnimationStyle,visible:s})}))))}shouldComponentUpdate(t,e){return!M()(this.props,t)||!Object(K.a)(this.state,e)}componentDidUpdate(t,e){t.list!==this.props.list&&(this._isInitialAnchoring||(this._previousItemMap=new Map,t.list.forEach((t=>{this._previousItemMap.set(t.id,t)})),this._areAnchorsInvalidated=!0,this._shouldPinToNewest()&&t.list.length!==this.props.list.length&&this.props.analytics.scribe({element:"scroller",action:"pin_to_top_attempt"})),this._scheduleCriticalUpdate()),t.cacheKey!==this.props.cacheKey&&(this._hasUserChangedFocus=!1),this._wasPreviouslyAtNewestEnd&&this.props.list.find((t=>t.id===j.a))&&this._getHeightForItemId(j.a)>0&&this.scrollToNewest()}componentDidMount(){this._removeScrollHandler=this._viewport.addScrollListener(this._handleScroll),this._removeProgrammaticScrollHandler=this._viewport.addProgrammaticScrollListener(this._handleProgrammaticScroll),this._removeFullscreenEnterHandler=H.a(this._handleEnterFullscreen),this._removeFullscreenExitHandler=H.b(this._handleExitFullscreen);const t=this._getInitialRenderedItems();if(this.props.isManualScrollRestoration&&this._viewport.scrollBy(-1),this._isInitialAnchoring=!0,t.length>0){const e=this._getDocumentViewportHeight();this.setState({renderedItems:t,shouldAnimate:!0,listHeightWithHeadroom:e},(()=>{const{initialAnchor:t}=this.props;t&&t.type===c.Anchor?(this._viewport.scrollBy(this._getViewportOffsetCorrection()),t.anchor.wasFocused&&this._updateFocusToItem(t.anchor.id)):t&&t.type===c.FocusedItem&&this._updateFocusToItem(t.itemId),window.requestAnimationFrame((()=>window.requestAnimationFrame((()=>this._scheduleCriticalUpdate()))))}))}else this._update()}componentWillUnmount(){this._removeScrollHandler&&this._removeScrollHandler(),this._removeProgrammaticScrollHandler&&this._removeProgrammaticScrollHandler(),this._removeFullscreenEnterHandler&&this._removeFullscreenEnterHandler(),this._removeFullscreenExitHandler&&this._removeFullscreenExitHandler(),this._removeViewportResizeHandler&&this._removeViewportResizeHandler(),this._reportVisibilityMeasurements()}_getDocumentViewportHeight(){var t;return(null===(t=document.documentElement)||void 0===t?void 0:t.clientHeight)||0}_getFinalRenderedItems(){const{list:t}=this.props,{renderedItems:e}=this.state;return this._getFinalRenderedItemsMemoized(t,e)}}o()(rt,"contextType",D.a),o()(rt,"defaultProps",{nearEndProximityRatio:1.75,nearStartProximityRatio:.25,assumedItemHeight:400,hasNewContentAtBottom:!1,minimumOffscreenToViewportRatio:.5,preferredOffscreenToViewportRatio:2.5});var ht=Object(L.a)(rt);const at=(t,e)=>{if(t.length)return t.reduce(((t,i)=>e(i,t)>0?i:t))},ct=(t,e)=>{const i=e*t.getHeight();return new P.a(t.getTop()-i,t.getHeight()+2*i)};let dt;const lt=()=>{dt=!1};class ut extends r.a.PureComponent{constructor(t,e){super(t,e),o()(this,"_renderer",r.a.createRef()),o()(this,"_isModal",!1),o()(this,"_getList",Object(w.a)(((t,e,i,s,o,n,r)=>{const h=[];return t&&h.push(a("$header","header",(()=>t),!0)),h.push(...i.map((t=>a(n(t),t,s,!o||o(t),r&&r(t))))),e&&h.push(a("$footer","footer",(()=>e),!1)),h}))),o()(this,"_render",(({isModal:t})=>{const{anchoring:e,assumedItemHeight:i,cacheKey:s,canBeAnchorFunction:o,footer:n,hasNewContentAtBottom:h,header:a,identityFunction:c,initialAnchor:_,items:p,renderer:g,sortIndexFunction:f,withKeyboardShortcuts:I,withoutHeadroom:w}=this.props,v=this._scrollRestorationAnchor[s],b=v?d(v):_?l(_.id):void 0;return t&&(this._isModal=!0,dt=!0),r.a.createElement(m.a,{enabled:I,handlers:{[u.e.refresh]:this._handleKeyboardRefresh,[u.e.nextItem]:this._handleKeyboardFocusNext,[u.e.previousItem]:this._handleKeyboardFocusPrevious}},r.a.createElement(ht,{assumedItemHeight:i,cacheKey:s,hasNewContentAtBottom:h,initialAnchor:b,isManualScrollRestoration:window.history&&"manual"===window.history.scrollRestoration,key:s,list:this._getList(a,n,p,g,o,c,f),onPositionUpdate:this._handlePositionUpdate,onScrollEnd:this._handleScrollEnd,pinToNewestWhenAtNewest:e.pinToNewestWhenAtNewest,ref:this._renderer,viewport:this._viewport,withoutHeadroom:w}))})),o()(this,"_handleScrollEnd",(()=>{this.props.onScrollEnd&&this.props.onScrollEnd()})),o()(this,"_handlePositionUpdate",(t=>{const{onItemsRendered:e}=this.props;this._edgeProximity.handlePositioningUpdate(t),e&&e({positions:t.getRenderedItems(),viewport:t.getForViewport()}),this._preservePosition(this._customLocation)})),o()(this,"_shouldPreventKeyboardShortcuts",(()=>dt&&!this._isModal)),o()(this,"_handleKeyboardRefresh",Object(v.a)((()=>{const{onKeyboardRefresh:t}=this.props;this._shouldPreventKeyboardShortcuts()||t&&t()}),1e3)),o()(this,"_handleKeyboardFocusNext",(()=>{!this._shouldPreventKeyboardShortcuts()&&this.adjustFocusBy(1)})),o()(this,"_handleKeyboardFocusPrevious",(()=>{!this._shouldPreventKeyboardShortcuts()&&this.adjustFocusBy(-1)})),o()(this,"isAtNewest",(()=>!this._renderer.current||this._renderer.current.isAtNewest()));const{nearEndProximityRatio:i,nearStartProximityRatio:s}=t;this._edgeProximity=new f.b([{condition:f.a.nearTop(5),callback:t=>this.props.onAtStart(t)},{condition:f.a.nearTopRatio(s),callback:t=>this.props.onNearStart(t)},{condition:f.a.nearBottomRatio(i),callback:t=>this.props.onNearEnd(t)},{condition:f.a.nearBottom(5),callback:t=>this.props.onAtEnd(t)}]),this._viewport=t.viewport||this.context&&this.context.viewport||g.a.root(),this._loadStoredPosition(t,this.context)}render(){const{items:t,noItemsRenderer:e}=this.props;return t.length?r.a.createElement(_.b.Consumer,null,this._render):e()}componentDidMount(){const{onPositionRestored:t}=this.props;t()}componentDidUpdate(t){const{cacheKey:e,onPositionRestored:i}=this.props;e!==t.cacheKey&&i()}UNSAFE_componentWillReceiveProps(t){const{cacheKey:e}=this.props;e!==t.cacheKey&&this._loadStoredPosition(t,this.context)}componentWillUnmount(){this._isModal&&(dt=!1)}_preservePosition(t){if(t&&this._renderer.current){const e=this._renderer.current.getAnchors();t.savePosition(e)}}_loadStoredPosition(t,e){const{getCustomLocation:i}=e;this._customLocation=i&&i();let s=[];if(this._customLocation){const t=this._customLocation.getSavedPosition();s=t&&t.length?t:[],s.length>0&&this._customLocation&&this._customLocation.claimScrollRestoration()}const o=s.find((({id:e,wasFocused:i})=>i&&t.items.some((i=>t.identityFunction(i)===e))))||s.find((({distanceToViewportTop:e,id:i})=>t.items.some((e=>t.identityFunction(e)===i))));this._scrollRestorationAnchor={[t.cacheKey]:o}}adjustFocusBy(t){this._renderer.current&&this._renderer.current.adjustFocusBy(t)}scrollToNewest(t){this._renderer.current&&this._renderer.current.scrollToNewest(t)}}o()(ut,"contextTypes",{viewport:I.object,getCustomLocation:I.func}),o()(ut,"defaultProps",{anchoring:p.a,hasNewContentAtBottom:!1,onPositionRestored:b.a,onAtEnd:b.a,onAtStart:b.a,onNearEnd:b.a,onNearStart:b.a,onScrollEnd:b.a,nearEndProximityRatio:1.75,nearStartProximityRatio:.25,noItemsRenderer:()=>null,assumedItemHeight:400,minimumOffscreenToViewportRatio:.5,preferredOffscreenToViewportRatio:2.5,withoutHeadroom:!1,withKeyboardShortcuts:!1})},JD1h:function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return h}));var s=Object.freeze({MOVEMENT:"movement",LIST_UPDATE:"list_update",INITIAL_POSITION:"initial_position"});const o={nearTop:t=>(e,i)=>i.getTop()-e.getTop()<=t,nearBottom:t=>(e,i)=>e.getBottom()-i.getBottom()<=t,nearTopRatio:t=>(e,i)=>{const s=i.getHeight()*t;return i.getTop()-e.getTop()<=s},nearBottomRatio:t=>(e,i)=>{const s=i.getHeight()*t;return e.getBottom()-i.getBottom()<=s}},n=Object.freeze({INSIDE:"inside",OUTSIDE:"outside"}),r=(t,e,i,o)=>((t,e)=>!t&&e===n.INSIDE)(t,i)?s.INITIAL_POSITION:((t,e)=>t===n.OUTSIDE&&e===n.INSIDE)(t,i)?s.MOVEMENT:((t,e)=>t===n.INSIDE&&e===n.INSIDE)(t,i)&&o!==e?s.LIST_UPDATE:null;class h{constructor(t){this._handlers=t.map((t=>({zone:t,state:{}})))}handlePositioningUpdate(t){this._handlers.forEach((({state:e,zone:i})=>{const{callback:s,condition:o}=i,{listLength:h,proximity:a}=e,c=((t,e)=>t(e.getForList(),e.getForViewport())?n.INSIDE:n.OUTSIDE)(o,t),d=t.getListLength(),l=r(a,h,c,d);e.proximity=c,e.listLength=d,l&&s({triggerCause:l})}))}}},dPJJ:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return c}));var s=i("6/RC");const o=new Set,n=new Set;let r=!1;function h(){if(s.canUseDOM&&!r){const t=["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"];["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","msfullscreenchange"].forEach((e=>{document.addEventListener(e,(()=>{const e=t.map((t=>document[t])).filter(Boolean)[0];e?o.forEach((t=>t(e))):n.forEach((t=>t()))}))}))}r=!0}const a=t=>(r||h(),o.add(t),()=>o.delete(t)),c=t=>(r||h(),n.add(t),()=>n.delete(t))},gbD7:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return h})),i.d(e,"c",(function(){return a}));i("ERkP");var s=i("aWyx");const o=(t,e)=>({entry:{id:e,time:"",type:t},isActive:!1,isRapidFire:!1,isFirstRapidFire:!1,isLastRapidFire:!1,type:t}),n=o(s.b.CONVERSATION_PROFILE_INFO_HEADER,"conversationProfileInfoHeader"),r="typingIndicator",h=o(s.b.TYPING_INDICATOR,r),a=o(s.b.READ_ONLY_INDICATOR,"readOnlyIndicator")},jHwr:function(t,e,i){"use strict";e.a=(t,e)=>{let i=null;const s=()=>{i=null,t()};return()=>(i||(i=e(s)),i)}},kgfz:function(t,e){function i(t){var e=[];for(var i in t)e.push(i);return e}(t.exports="function"==typeof Object.keys?Object.keys:i).shim=i}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.AbsolutePower.7db6b825.js.map