(window.webpackJsonp=window.webpackJsonp||[]).push([[181],{"3GUV":function(e,t,i){"use strict";var n=i("ERkP"),s=i.n(n),r=i("rHpw"),a=i("MWbm");class o extends s.a.Component{shouldComponentUpdate(){return!1}render(){return s.a.createElement(a.a,{style:c.root})}}const c=r.a.create((e=>({root:{height:5*e.lineHeightsPx.body}})));t.a=o},"5UID":function(e,t,i){"use strict";var n=i("ERkP"),s=i.n(n),r=i("3XMw"),a=i.n(r),o=i("rHpw"),c=i("+/1j"),l=i("MWbm");const h=a.a.e5b0063d;let d=0;class p extends s.a.Component{constructor(){super(),this._listDomId=`accessible-list-${d}`,d+=1}render(){const{children:e,title:t}=this.props,i=h({title:t});return s.a.createElement(l.a,{accessibilityLabelledBy:this._listDomId,accessibilityRole:"region"},s.a.createElement(c.a,{accessibilityLevel:1,accessibilityRole:"heading",nativeID:this._listDomId,style:o.a.visuallyHidden},t),s.a.createElement(l.a,{accessibilityLabel:i},e))}}t.a=p},VeNJ:function(e,t,i){"use strict";i.r(t),i.d(t,"TimelineRenderer",(function(){return ve}));var n=i("KEM+"),s=i.n(n),r=i("ejT/"),a=i("ERkP"),o=i.n(a),c=i("5UID"),l=i("6/RC"),h=i("1YZw"),d=i("rxPX"),p=Object(d.a)().propsFromActions((()=>({addToast:h.b}))).withAnalytics(),m=i("KNCp"),_=i("lUZE");var u=Object.freeze({Icon:"Icon",IconSmall:"IconSmall",FullWidth:"FullWidth"}),v=i("caTy"),g=i("rcen"),b=i("TnY3"),y=i("TIdA"),C=i("A91F"),w=i("feu+"),f=i("tI3i"),E=i.n(f),I=l.canUseDOM?window.location.href:"",T=function(){function e(){var e=this;this._eventCallbacks={},this.addEventListener=function(t,i){e._eventCallbacks[t]?e._eventCallbacks[t].push(i):e._eventCallbacks[t]=[i]},this.removeEventListener=function(t,i){var n=e._eventCallbacks[t].filter((function(e){return e.toString()!==i.toString()}));e._eventCallbacks[t]=n}}var t=e.prototype;return t._dispatchEvent=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var s=this._eventCallbacks[e];null!=s&&Array.isArray(s)&&s.map((function(e){e.apply(void 0,i)}))},t.canOpenURL=function(){return Promise.resolve(!0)},t.getInitialURL=function(){return Promise.resolve(I)},t.openURL=function(e){try{return k(e),this._dispatchEvent("onOpen",e),Promise.resolve()}catch(e){return Promise.reject(e)}},t._validateURL=function(e){E()("string"==typeof e,"Invalid URL: should be a string. Was: "+e),E()(e,"Invalid URL: cannot be empty")},e}(),k=function(e){if(l.canUseDOM){var t=new URL(e,window.location).toString();window.open(t,"_blank","noopener")}},L=new T,S=i("MWbm"),R=i("oQhu"),x=i("fs1G");class A extends o.a.PureComponent{constructor(...e){super(...e),s()(this,"_getGraphicProps",Object(R.a)(((e,t)=>{const i=e?({style:t})=>o.a.createElement(S.a,{style:t},o.a.createElement(y.a,{accessibilityLabel:"",aspectMode:C.a.exact(e.width/e.height),image:e})):_.a;let n="illustration";return e&&t!==u.IconSmall?t===u.FullWidth&&(n="illustrationFullWidth"):n="icon",{graphic:i,graphicDisplayMode:n}}))),s()(this,"_scribeAction",((e,t)=>{const{analytics:i}=this.props,{action:n,component:s,element:r}=t||{};i.scribe({action:n||e,component:s||"cover",element:r})})),s()(this,"_handleDismiss",(()=>{const{dismissInfo:e,processCallback:t}=this.props,{callbacks:i}=e||{};i&&i.forEach((e=>{t(e)})),e&&(this._scribeAction("dismiss"),this.props.onClose())})),s()(this,"_handlePrimaryCtaClick",(()=>{this._handleCtaClick(this.props.primaryCta,"primary_cta")})),s()(this,"_handleSecondaryCtaClick",(()=>{this.props.secondaryCta&&this._handleCtaClick(this.props.secondaryCta,"secondary_cta")})),s()(this,"_handleCtaClick",(({callbacks:e,clientEventInfo:t,ctaBehavior:i},n)=>{const{addToast:s,history:r,processCallback:a}=this.props;if(this.props.onClose(),this._scribeAction("click",{element:n,...t}),i.dismiss){const{dismiss:e}=i;e&&e.feedbackMessage&&s({text:e.feedbackMessage.text})}if(i.navigate){const{navigate:e}=i,t=e&&Object(v.b)(e.url);t&&(t.external?L.openURL(t.pathname):r.push(t.pathname))}e&&e.forEach((e=>a(e)))}))}componentDidMount(){this.props.onImpression&&this.props.onImpression()}render(){const{details:e,dismissInfo:t,displayType:i,image:n,imageDisplayType:s,primaryCta:r,primaryText:a,secondaryCta:c,secondaryText:l,type:h}=this.props,d=o.a.createElement(g.a,{entities:a.entities,text:a.text}),p=l?o.a.createElement(g.a,{entities:l.entities,text:l.text}):null;if(h===m.a.Full){const a=e?o.a.createElement(g.a,{entities:e.entities,text:e.text}):null,{graphic:l,graphicDisplayMode:h}=this._getGraphicProps(n,s);return o.a.createElement(w.a,{actionLabel:r.text,footer:a,graphic:l,graphicDisplayMode:h,headline:d,isFullHeightOnMobile:!t&&"CenterCover"!==i,onAction:this._handlePrimaryCtaClick,onClose:this._handleDismiss,onTertiaryAction:this._handleSecondaryCtaClick,subtext:p,tertiaryActionLabel:c&&c.text,withCloseButton:!!t})}return o.a.createElement(w.a,{actionLabel:r.text,graphicDisplayMode:"none",headline:d,onAction:this._handlePrimaryCtaClick,onClose:x.a,onSecondaryAction:this._handleSecondaryCtaClick,secondaryActionLabel:c&&c.text,subtext:p,withCloseButton:!1})}}s()(A,"defaultProps",{imageDisplayType:u.Icon});var D=Object(b.a)(p(A));const M={component:"cover",action:"impression"};var O=({activeCover:e,clearActiveCover:t,processCallback:i,scribeAction:n,scribeNamespace:s})=>{const r=((e,t)=>{let i={...e,...M};return t&&(i={...i,component:t.component||i.component,element:t.element||i.element,action:t.action||i.action}),i})(s,e.clientEventInfo),a=()=>{const{cover:{impressionCallbacks:t}}=e;t&&t.forEach((e=>i(e))),n(r)};return"full"===e.type?(c=e.cover,o.a.createElement(D,{details:c.details||void 0,dismissInfo:c.dismissInfo,displayType:c.displayType,image:c.image,imageDisplayType:c.imageDisplayType||void 0,onClose:t,onImpression:a,primaryCta:c.primaryCoverCta,primaryText:c.primaryText,processCallback:i,secondaryCta:c.secondaryCoverCta,secondaryText:c.secondaryText,type:"full"})):"half"===e.type?function(e){const n="CenterCover"===e.displayType?"full":"half";return o.a.createElement(D,{displayType:e.displayType,image:e.coverImage?e.coverImage.image:void 0,imageDisplayType:e.coverImage?e.coverImage.imageDisplayType:void 0,onClose:t,onImpression:a,primaryCta:e.primaryCoverCta,primaryText:e.primaryText,processCallback:i,secondaryCta:e.secondaryCoverCta,secondaryText:e.secondaryText,type:n})}(e.cover):null;var c},N=i("MDbM"),P=i("Qyxo");class U{constructor(){this._lingerScribed={},this._appearance={}}processPositioningUpdate(e,t,i=Date.now()){const n=F(e,t);return{lingers:this._lingerTransition(n,i),impressions:B(e,t)}}flushLingerEvents(e=Date.now()){return this._detectScribeLingerEvents(this._appearance,{},e)}_lingerTransition(e,t){const i=this._appearance;return this._appearance=e.reduce(((e,n)=>(e[n]=i[n]||{start:t,lingered:!1},e)),{}),{allLingerIds:this._detectAllLingerEvents(i,t),scribeLingerEvents:this._detectScribeLingerEvents(i,this._appearance,t)}}_detectAllLingerEvents(e,t){return Object.keys(e).reduce(((i,n)=>{const{lingered:s,start:r}=e[n];return!s&&t-r>=500&&(i.push(n),this._appearance[n]&&(this._appearance[n]={...this._appearance[n],lingered:!0})),i}),[])}_detectScribeLingerEvents(e,t,i){return Object.keys(e).reduce(((n,s)=>{const{start:r}=e[s];return!t[s]&&!this._lingerScribed[s]&&i-r>=500&&(this._lingerScribed[s]=!0,n.push({id:s,start:r,end:i})),n}),[])}}const F=(e,t)=>Object(P.a)(e,(({id:e,rectangle:i})=>H(i,t)>=.5*i.getHeight()?e:void 0)),B=(e,t)=>Object(P.a)(e,(({id:e,rectangle:i})=>H(i,t)>=.99?{id:e,relativeElementHeight:j(i.getHeight(),t.getHeight())}:void 0)),H=(e,t)=>Math.max(0,Math.min(e.getBottom(),t.getBottom())-Math.max(e.getTop(),t.getTop())),j=(e,t)=>Math.floor(e/t*1e5),V={threshold:[.01,.5]};var W=class{constructor(e){s()(this,"_itemsUnderObservation",{}),s()(this,"_lingerCandidates",new Map),s()(this,"_reactivityCandidates",new Map),s()(this,"_lingerEvents",new Map),s()(this,"_impressionEvents",new Map),s()(this,"getLingerEvents",((e=Date.now())=>Array.from(this._lingerEvents.keys()).map((e=>this._getLingerEventForId(e))).filter(Boolean))),s()(this,"_getLingerEventForId",(e=>{const t=this._lingerEvents.get(e);if(t&&!t.scribed)return this._lingerEvents.set(e,{...t,scribed:!0}),{id:e,start:t.start,end:t.end}})),s()(this,"_getOngoingLingerEvents",(e=>{const t=[];return this._lingerCandidates.forEach(((i,n)=>{e-i>=500&&t.push({id:n,start:i,end:e})})),t})),s()(this,"_processIntersectionEntries",(e=>{const t=Date.now();e.forEach((e=>{const i=Object.entries(this._itemsUnderObservation).find((([t,i])=>i===e.target));if(i){const n=i[0],{boundingClientRect:s,intersectionRatio:r,rootBounds:a}=e;if(r>=.01){const e=null!=s&&null!=a;this._createImpressionCandidate(n,e?j(s.height,a.height):void 0)}r>=.5?(this._createLingerCandidate(n,t),this._createReactivityCandidate(n,t)):(this._transitionCandidateToLingerEvent(n,t),this._removeReactivityCandidate(n))}}))})),s()(this,"_createImpressionCandidate",((e,t)=>{this._impressionEvents.set(e,{relativeElementHeight:t})})),s()(this,"_createLingerCandidate",((e,t)=>{this._lingerCandidates.has(e)||this._lingerCandidates.set(e,t)})),s()(this,"_transitionCandidateToLingerEvent",((e,t)=>{const i=this._lingerCandidates.get(e);void 0===i||this._lingerEvents.has(e)||t-i>=500&&this._lingerEvents.set(e,{start:i,end:t,scribed:!1}),this._lingerCandidates.delete(e)})),s()(this,"_createReactivityCandidate",((e,t)=>{if(!this._reactivityCandidates.has(e)){const t=window.setTimeout((()=>{this._reactivityCallback(e),this._reactivityCandidates.delete(e)}),500);this._reactivityCandidates.set(e,t)}})),s()(this,"_removeReactivityCandidate",(e=>{window.clearTimeout(this._reactivityCandidates.get(e)),this._reactivityCandidates.delete(e)})),null!=e&&e.root&&e.root===window.document&&(e.root=null);const t={...V,...e};this._observer=new IntersectionObserver(this._processIntersectionEntries,t),this._reactivityCallback=e&&e.reactivityCallback||x.a}observe(e,t){e&&(this._itemsUnderObservation[t]=e,this._observer.observe(e))}unobserve(e,t){e&&(this._observer.unobserve(e),delete this._itemsUnderObservation[t],this._removeReactivityCandidate(t))}disconnect(){this._observer.disconnect()}getImpressionEvents(){const e=Array.from(this._impressionEvents,(([e,t])=>({id:e,relativeElementHeight:t.relativeElementHeight})));return this._impressionEvents.clear(),e}flushLingerEvents(e=Date.now()){const t=this.getLingerEvents(e),i=this._getOngoingLingerEvents(e);return this._lingerCandidates.clear(),t.concat(i)}},z=i("LFzM");var G=({children:e,impressionTracker:t})=>t?o.a.createElement(z.a.Provider,{value:{impressionTracker:t}},e):e,K=i("3GUV"),q=i("v//M"),J=i("rHpw"),X=i("VPAj"),Q=i("0zXz");const Y=Object(X.a)(o.a.createElement(K.a,null)),Z=({bottomFetchStatus:e,onBottomRetry:t,withEndOfContent:i})=>o.a.createElement(S.a,{style:i&&$.footer},o.a.createElement(q.a,{fetchStatus:e,onRequestRetry:t,render:i?Y:Q.a})),$=J.a.create((e=>({footer:{height:5*e.lineHeightsPx.body}})));var ee=o.a.memo(Z),te=i("xjVt"),ie=i("EUHl"),ne=i("IG4P"),se=i("iBK2"),re=i("pbku"),ae=i("aITJ"),oe=i("aWzz"),ce=i("iChn"),le=i("8UdT"),he=i("cFgU"),de=i("WA1W");const pe=e=>e.entryId,me=e=>e.sortIndex;const _e=new Map,ue=e=>{switch(e){case le.b.Tweet:return ae.b.isDesktopOS()?250:400;case le.a.ModuleImpressionPlaceholder:return 0;default:return 100}};class ve extends o.a.PureComponent{constructor(e,t){var i;super(e,t),s()(this,"_promotedTweetDistanceMap",new Map),s()(this,"_renderFooter",(()=>{const{bottomFetchStatus:e,footer:t=null,onBottomRetry:i,showLoadingFooter:n}=this.props;return n?o.a.createElement(o.a.Fragment,null,o.a.createElement(ee,{bottomFetchStatus:e,onBottomRetry:i,withEndOfContent:!t}),t):t})),s()(this,"_refreshControlWrapper",(e=>{const{canRefresh:t,onRefresh:i,refreshControl:n,topFetchStatus:s}=this.props;return n?o.a.createElement(n,{canRefresh:t,isRefreshing:s===N.a.LOADING,onRefresh:i},e):e})),s()(this,"_getCellRenderer",Object(R.a)(((e,t)=>{let i;const n={module:t,renderEntry:e=>i(e)};return i=(t,i)=>{const s=e.getHandler(t),r=e.getDisplayType(t)||void 0;return s&&s.render?s.render(t,n,i,r):null},i}))),s()(this,"_getInitialFocusedEntry",Object(R.a)(((e,t)=>t&&e.find(t)))),s()(this,"_createEntryIndex",Object(R.a)((e=>Object(ce.a)(e,(e=>e.entryId))))),s()(this,"_handleBeforeWindowUnload",(()=>{this._flushLingerScribes()})),s()(this,"_handleKeyboardRefresh",(()=>{this.refreshOrGoTop(!0)})),s()(this,"scrollToTop",(e=>{if(this._scroller){const{applyNewTweetsBarInstructions:t}=this.props;t&&t(),this._scroller.scrollToNewest(e)}})),s()(this,"_handleAtBottom",this._proximityHandler((()=>{this.props.onAtBottom&&this.props.onAtBottom()}))),s()(this,"_handleNearBottom",this._proximityHandler((()=>{this.props.onNearBottom()}))),s()(this,"_handleNearTop",this._proximityHandler((()=>{const{onNearTop:e}=this.props;e()}))),s()(this,"_handleAtTop",this._proximityHandler((()=>{const{onAtTop:e,removeAlert:t,richScribeAction:i,scribeNamespace:n}=this.props;t&&t(),e&&e();i({...n,component:"stream",element:"top",action:"show"})}))),s()(this,"_handleItemsRendered",this._proximityHandler((({positions:e,viewport:t})=>{if(this.props.onEntriesRendered&&this.props.onEntriesRendered(),this._V2ImpressionsEnabled())this._handleProcessLingerAndImpressionEvents();else{const{impressions:i,lingers:n}=this._impressionTracker.processPositioningUpdate(e,t);this._scribeLingerEvents(n.scribeLingerEvents),this._handleOnLingerEvents(n.allLingerIds),this._scribeImpressionEvents(i)}}))),s()(this,"_scribeImpressionEvents",(e=>{var t;const i=this._getEntryIndex(),n=null===(t=this.context.featureSwitches)||void 0===t?void 0:t.isTrue("responsive_web_element_size_impression_scribe_enabled"),s=Object(P.a)(e,(e=>{const t=i[e.id];return null!=t?{entry:t,relativeElementHeight:n?e.relativeElementHeight:void 0}:null}));this._scribeNewEntries(s)})),s()(this,"_handleProcessLingerAndImpressionEvents",(()=>{if(this._impressionTrackerV2){var e;const t=this._impressionTrackerV2.getLingerEvents();this._scribeLingerEvents(t);const i=(null===(e=this._impressionTrackerV2)||void 0===e?void 0:e.getImpressionEvents())||[];this._scribeImpressionEvents(i)}})),s()(this,"_handleOnLingerEvents",(e=>{e.forEach((e=>this._handleOnLingerEvent(e)))})),s()(this,"_handleOnLingerEvent",(e=>{const{applyReactionInstructions:t}=this.props,i=this._getEntryIndex()[e];i&&t({entry:i,triggerName:re.a.ON_LINGER})})),s()(this,"_handlePositionRestored",(()=>{this._positionedRestored=!0})),s()(this,"_scheduleNewEntriesScribing",(i=e=>{const{richScribeAction:t,scribeNamespace:i}=this.props,n=this._buildStreamScribeData(e);n.length>0&&t({...i,component:"stream",action:"results"},{items:n})},l.canUseDOM&&window.requestIdleCallback?e=>{const t=window.requestIdleCallback((()=>i(e)));return()=>window.cancelIdleCallback(t)}:l.canUseDOM&&window.requestAnimationFrame?e=>{const t=window.requestAnimationFrame((()=>i(e)));return()=>window.cancelAnimationFrame(t)}:()=>x.a)),s()(this,"_setScroller",(e=>{this._scroller=e})),s()(this,"_V2ImpressionsEnabled",(()=>{var e;return l.canUseDOM&&(null===(e=this.context.featureSwitches)||void 0===e?void 0:e.isTrue("responsive_web_linger_refactor_enabled"))})),s()(this,"_newImpressionTrackerV2",(()=>this._V2ImpressionsEnabled()&&window.IntersectionObserver?new W({root:this.context.viewport.getViewport(),rootMargin:this.context.viewport.getRootMargin(),reactivityCallback:this._handleOnLingerEvent}):void 0)),this._impressionTracker=new U,this._streamScribeCancelCallbacks=[],this._impressionTrackerV2=this._newImpressionTrackerV2()}UNSAFE_componentWillReceiveProps(e){this.props.timelineId!==e.timelineId&&(this._flushLingerScribes(),this._impressionTracker=new U,this._impressionTrackerV2&&this._impressionTrackerV2.disconnect(),this._impressionTrackerV2=this._newImpressionTrackerV2())}componentDidMount(){const{onRef:e}=this.props;this._initialize(),window.addEventListener("beforelogout",this._handleBeforeWindowUnload),window.addEventListener("beforeunload",this._handleBeforeWindowUnload),e&&e(this)}componentWillUnmount(){var e;const{onRef:t}=this.props;this._flushLingerScribes(),this._cancelStreamScribeCallbacks(),window.removeEventListener("beforelogout",this._handleBeforeWindowUnload),window.removeEventListener("beforeunload",this._handleBeforeWindowUnload),t&&t(void 0),null===(e=this._impressionTrackerV2)||void 0===e||e.disconnect()}componentDidUpdate(e){const{entries:t,handlerRegistry:i,onRef:n,timelineId:s}=this.props;s!==e.timelineId?this._initialize():t===e.entries&&i===e.handlerRegistry||this._initialize(),n&&n!==e.onRef&&n(this)}render(){var e;const{anchoring:t,entries:i,handlerRegistry:n,header:s,isInitialFocusEntry:a,module:l,nearStartProximityRatio:h,renderEmptyState:d,timelineId:p,title:m,withKeyboardShortcuts:_,withoutHeadroom:u}=this.props,v=this.props.scroller,g=this._getInitialFocusedEntry(i,a);return this._refreshControlWrapper(this._shouldRenderEmptyState(i)?d():o.a.createElement(G,{impressionTracker:this._impressionTrackerV2},o.a.createElement(c.a,{title:m},this._renderActiveCover(),this._renderPill(),o.a.createElement(v,{anchoring:t,assumedItemHeight:ue,cacheKey:p,footer:this._renderFooter(),hasNewContentAtBottom:null===(e=this.context.featureSwitches)||void 0===e?void 0:e.isTrue("responsive_web_do_not_launch_me_reverse_home_timeline_enabled"),header:s,identityFunction:pe,initialAnchor:g&&r.b(pe(g)),items:i,nearStartProximityRatio:h,onAtEnd:this._handleAtBottom,onAtStart:this._handleAtTop,onItemsRendered:this._handleItemsRendered,onKeyboardRefresh:this._handleKeyboardRefresh,onNearEnd:this._handleNearBottom,onNearStart:this._handleNearTop,onPositionRestored:this._handlePositionRestored,ref:this._setScroller,renderer:this._getCellRenderer(n,l),sortIndexFunction:me,withKeyboardShortcuts:_,withoutHeadroom:u}))))}_renderPill(){const{alert:e,applyNewTweetsBarInstructions:t,newTweetsPillLabel:i,newTweetsPillMode:n,removeAlert:s,scribeNamespace:r,timelineId:a,topUnseenCount:c}=this.props;return n?n===ie.a.URT?o.a.createElement(te.a.Configure,{alert:e,applyNewTweetsBarInstructions:t,isAtNewest:null===(l=this._scroller)||void 0===l?void 0:l.isAtNewest,label:i,removeAlert:s,scribeNamespace:r,timelineId:a}):n===ie.a.CLIENT&&c&&c>0?o.a.createElement(te.a.Configure,{applyNewTweetsBarInstructions:t,removeAlert:s,scribeNamespace:r,timelineId:a,unreadCount:c}):void 0:null;var l}_renderActiveCover(){const{activeCover:e,clearActiveCover:t,processCallback:i,scribeAction:n,scribeNamespace:s}=this.props,r=e&&e.cover;return e&&r?o.a.createElement(O,{activeCover:e,clearActiveCover:t,processCallback:i,scribeAction:n,scribeNamespace:s}):null}_shouldRenderEmptyState(e){const{activeCover:t,initialFetchStatus:i}=this.props,n=i===N.a.LOADED,s=0===e.length;return n&&s&&!t}_getEntryIndex(){return this._createEntryIndex(this.props.entries)}_initialize(){this._createPromotedTweetDistanceMap()}_createPromotedTweetDistanceMap(){const{entries:e}=this.props;this._promotedTweetDistanceMap=new Map;let t=null;e.forEach((e=>{var i;let n=!1;null!==(i=e.content)&&void 0!==i&&i.promotedMetadata&&(n=e.content.promotedMetadata),n&&null!==t&&this._promotedTweetDistanceMap.set(e.entryId,t),n?t=0:null!==t&&-1===e.type.indexOf("ui_")&&(t+=1)}))}_flushLingerScribes(){const e=this._impressionTrackerV2?this._impressionTrackerV2.flushLingerEvents():this._impressionTracker.flushLingerEvents();this._scribeLingerEvents(e)}refreshOrGoTop(e){this._scroller&&!this._scroller.isAtNewest()?this.scrollToTop(e):this.props.onRefresh()}scrollAndFocusNewest(){this._scroller&&this._scroller.scrollToNewest(!0)}_proximityHandler(e){return t=>{this._positionedRestored&&e(t)}}_scribeNewEntries(e){const t=this._scheduleNewEntriesScribing(e);for(this._streamScribeCancelCallbacks.push(t);this._streamScribeCancelCallbacks.length>=20;)this._streamScribeCancelCallbacks.shift()}_buildStreamScribeData(e){const{handlerRegistry:t,scribeCache:i,timelineId:n}=this.props;if(!i.has(n)){const e=new Set;i.set(n,e)}const s=i.get(n);return s?e.reduce(((e,i,n)=>{const{entry:r,relativeElementHeight:a}=i,{entryId:o}=r;if(!s.has(o)&&!t.getNeedsLoad(r)){s.add(o);const i=this._getScribeDataItem(t,r);if(i){var c;const t=!(null===(c=r.content)||void 0===c||!c.promotedMetadata),n=this._promotedTweetDistanceMap.get(o);t&&n&&(i.tweet_count=n),null!=a&&(i.percent_screen_height_100k=a),e.push(i)}}return e}),[]):[]}_storeSeenIds(e){const{seenIds:t,seenIdsLatest:i,timelineId:n}=this.props;n!==de.d&&n!==de.b||!t?n!==de.c&&n!==de.a||!i||i.addNewTweets(e):t.addNewTweets(e)}_scribeLingerEvents(e){if(0===e.length)return;const{handlerRegistry:t}=this.props,i=this._getEntryIndex(),n=[],s=[];if(e.forEach((({end:e,id:r,start:a})=>{const o=i[r];if(o){const i=this._getScribeDataItem(t,o);if(i){const t={visibility_start:a,visibility_end:e};n.push({...i,impression_details:t})}if(o.type===le.b.Tweet){const e=o;s.push(e.content.id)}if(o.type===le.b.PagedCarouselItem){const e=o,t=e.content.content&&e.content.content.pagedCarouselFeedbackItem&&e.content.content.pagedCarouselFeedbackItem.content.tweet.id;t&&s.push(t)}}})),n.length>0){const{richScribeAction:e,scribeNamespace:t}=this.props;e({...t,component:"stream",element:"linger",action:"results"},{items:n})}s.length>0&&this._storeSeenIds(s)}_getScribeDataItem(e,t){const i=e.getHandler(t);if(i)return i.getScribeDataItem(t)}_cancelStreamScribeCallbacks(){this._streamScribeCancelCallbacks.forEach((e=>e()))}}s()(ve,"contextTypes",{viewport:oe.object,featureSwitches:oe.any}),s()(ve,"defaultProps",{onBottomRetry:x.a,onNearBottom:x.a,onNearTop:x.a,onRefresh:x.a,refreshControl:ne.a,scribeCache:_e,scroller:se.b,seenIds:Object(he.b)(),seenIdsLatest:Object(he.a)(),withoutHeadroom:!1,showLoadingFooter:!0,withKeyboardShortcuts:!0});t.default=ve},"ejT/":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n=e=>({id:e,distanceToViewportTop:0}),s=e=>({id:e,distanceToViewportBottom:0})}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.TimelineRenderer.3dc18355.js.map